webpackJsonp([8],{"/NiU":function(e,t){},"2jtW":function(e,t){},"4GeM":function(e,t){},"7fhe":function(e,t){},"A+Aw":function(e,t){},Aatg:function(e,t){},Aju2:function(e,t){},B7We:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={render:function(){var e=this.$createElement;return(this._self._c||e)("router-view")},staticRenderFns:[]};var s=a("VU/8")({data:function(){return{}},methods:{}},i,!1,function(e){a("kX+E")},"data-v-3da26f6a",null);t.default=s.exports},GSVh:function(e,t){},Hvgt:function(e,t){},L5Uz:function(e,t){},UH8q:function(e,t){},XnEw:function(e,t){},dzx0:function(e,t){},iYsa:function(e,t){},"kX+E":function(e,t){},lmcD:function(e,t){},lyKt:function(e,t){},"oBZ+":function(e,t){},oH9T:function(e,t){},"ra+q":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("fZjL"),s=a.n(i),n=a("mvHQ"),o=a.n(n),r=a("woOf"),l=a.n(r),c=a("g5kf"),d=a("nnhM"),p=a("TLh+"),m={props:{value:{type:Boolean,default:!1},"node-detail":{type:Object,default:function(){return{}}}},data:function(){return{formData:{nodeName:"",nodeType:""},nodeList:p.l,ruleValidate:{nodeName:[{required:!0,message:this.$t("inputField",{field:this.$t("nodeName")}),trigger:"blur"},{max:100,message:this.$t("errorMaxLength",{field:this.$t("nodeName"),length:100}),trigger:"blur"}],nodeType:[{required:!0,message:this.$t("selectField",{msg:this.$t("nodeType")}),trigger:"blur"}]}}},methods:{changeValue:function(e){this.$emit("input",e)},visibleChange:function(e){!1===e&&(this.resetFormData(),this.$refs.formValidate.resetFields())},cancel:function(){this.$emit("input",!1)},confirm:function(){var t=this;this.$refs.formValidate.validate(function(e){e&&("company"===t.formData.nodeType?t.$emit("add-com-modal-show",JSON.parse(o()(t.formData))):"scene"===t.formData.nodeType?t.$emit("add-scene-modal-show",JSON.parse(o()(t.formData))):"cashier"===t.formData.nodeType?t.$emit("add-cashier-modal-show",JSON.parse(o()(t.formData))):"department"===t.formData.nodeType&&t.$emit("add-department",JSON.parse(o()(t.formData))),t.$emit("input",!1))})},resetFormData:function(){for(var e in this.formData)this.formData[e]=""}},computed:{nodeListCanChose:function(){return this.nodeDetail?"company"===this.nodeDetail.nodeType?this.nodeList.filter(function(e){return"cashier"!==e.label}):"scenic"===this.nodeDetail.nodeType?this.nodeList.filter(function(e){return"company"!==e.label}):[]:[]}}},u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Modal",{staticClass:"add-node",attrs:{title:"Title","mask-closable":!1,value:t.value,"class-name":"vertical-center-modal"},on:{input:t.changeValue,"on-visible-change":t.visibleChange}},[a("div",{directives:[{name:"w-title",rawName:"v-w-title",value:t.$t("createNodeMsg",{node:t.nodeDetail.orgName}),expression:"$t('createNodeMsg',{node : nodeDetail.orgName})"}],staticClass:"target-class",attrs:{slot:"header"},slot:"header"},[a("span",{staticClass:"title"},[t._v(t._s(t.$t("createNodeMsg",{node:t.nodeDetail.orgName})))])]),t._v(" "),a("Form",{ref:"formValidate",attrs:{model:t.formData,rules:t.ruleValidate,"label-width":100}},[a("FormItem",{attrs:{label:t.$t("nodeName"),prop:"nodeName"}},[a("Input",{staticStyle:{width:"280px"},model:{value:t.formData.nodeName,callback:function(e){t.$set(t.formData,"nodeName",e)},expression:"formData.nodeName"}})],1),t._v(" "),a("FormItem",{attrs:{label:t.$t("nodeType"),prop:"nodeType"}},[a("Select",{staticStyle:{width:"280px"},model:{value:t.formData.nodeType,callback:function(e){t.$set(t.formData,"nodeType",e)},expression:"formData.nodeType"}},t._l(t.nodeListCanChose,function(e){return a("Option",{key:e.value,attrs:{value:e.value}},[t._v("\n                    "+t._s(t.$t(e.label))+"\n                ")])}))],1)],1),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{staticClass:"ivu-btn-90px",attrs:{type:"primary"},on:{click:t.confirm}},[t._v(t._s(t.$t("confirm")))]),t._v(" "),a("Button",{staticClass:"ivu-btn-90px",on:{click:t.cancel}},[t._v(t._s(t.$t("cancel")))])],1)],1)},staticRenderFns:[]};var f=a("VU/8")(m,u,!1,function(e){a("Hvgt")},"data-v-2f776a58",null).exports,h=a("YEFv"),v={matchesSelector:function(e,t){if(e){if(e.matches)return e.matches(t);if(e.matchesSelector)return e.matchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.mozMatchesSelector)return e.mozMatchesSelector(t);if(e.oMatchesSelector)return e.oMatchesSelector(t);if(e.querySelectorAll){for(var a=(e.document||e.ownerDocument).querySelectorAll(t),i=0;a[i]&&a[i]!==e;)i++;return!!a[i]}throw new Error("您的浏览器版本太旧了")}},getOffsetTop:function(e,t){return e?v.matchesSelector(e,t)?0:e.offsetTop+v.getOffsetTop(e.offsetParent,t):0},getOffsetLeft:function(e,t){return e?v.matchesSelector(e,t)?0:e.offsetLeft+v.getOffsetLeft(e.offsetParent,t):0},getOffset:function(e,t){return e?{top:this.getOffsetTop(e,t),left:this.getOffsetLeft(e,t)}:null},getStyle:function(e){return window.getComputedStyle?window.getComputedStyle(e,null):e.currentStyle},closest:function(e,t){return v.matchesSelector(e,"body")?void 0!==t&&"body"!==t?null:e:v.matchesSelector(e,t)?e:v.closest(e.parentElement,t)},getHasPosParentEl:function(e){if(v.matchesSelector(e,"body"))return e;var t=v.getStyle(e.parentElement);return t.position&&"static"!==t.position?e.parentElement:v.getHasPosParentEl(e.parentElement)},getHasScrollParentEl:function(e){if(v.matchesSelector(e,"body"))return e;var t=v.getStyle(e.parentElement);return t.overflow&&"auto,scroll".includes(t.overflow)||t["overflow-x"]&&"auto,scroll".includes(t["overflow-x"])||t["overflow-y"]&&"auto,scroll".includes(t["overflow-y"])?e.parentElement:v.getHasScrollParentEl(e.parentElement)},getAllHasScrollParentEls:function(e){var i=this,s=[];return function e(t){var a=i.getHasScrollParentEl(t);i.matchesSelector(a,"body")||a&&(s.push(a),e(a))}(e),s}},y=v,g=a("gyMJ"),D={name:"KCityPicker",props:{type:{type:String,default:"a"},transfer:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},placeholder:{type:String,default:"请选择"},defaultValue:{type:Object,default:function(){return{}}}},data:function(){return{curVal:"",visible:!1,style:null,hovering:!1,view:"p",provinces:{"A-G":[],"H-K":[],"L-S":[],"T-Z":[]},citys:[],areas:[],select:{province:null,city:null,area:null,value:""},provinceInfoList:[],cityInfoList:[],areaInfoList:[]}},computed:{iconClearShow:function(){return!this.disabled&&this.hovering&&this.curVal}},methods:{onClickSuffix:function(e){this.iconClearShow&&(this.select.province=this.select.city=this.select.area=null,this.callback(),e.stopPropagation())},onClickInput:function(e){this.disabled||(this.visible?this.hide():this.show())},onClickItem:function(e){switch(this.view){case"p":this.select.province=e,"p"===this.type?(this.callback(),this.hide()):this.queryCityInfoList(e.provinceid);break;case"c":this.select.city=e,"c"===this.type?(this.callback(),this.hide()):this.getSysAreassByCityid(e.cityid);break;case"a":this.select.area=e,"a"===this.type&&(this.callback(),this.hide())}},callback:function(){switch(this.type){case"p":this.select.city=this.select.area=null;break;case"c":this.select.area=null}this.curVal=this.select.value=(this.select.province&&this.select.province.province||"")+(this.select.city&&""+this.select.city.city||"")+(this.select.area&&""+this.select.area.area||""),this.$emit("select",this.select)},setSelect:function(t){t?t.value?this.curVal=this.select.value=t.value:(t.province&&(this.select.province=provinces.find(function(e){return e.code===t.province})),t.city&&(this.select.city=citys.find(function(e){return e.code===t.city})),t.area&&(this.select.area=areas.find(function(e){return e.code===t.area})),this.curVal=this.select.value=(this.select.province&&this.select.province.name||"")+(this.select.city&&this.select.city.name||"")+(this.select.area&&this.select.area.name||"")):(this.select.province=null,this.select.city=null,this.select.area=null,this.curVal="")},setValue:function(e){this.setSelect({value:e})},show:function(){var e=this;this.visible||(this.view="p",this.$nextTick(function(){e.visible=!0,e.setPos()}))},setPos:function(){var s=this;this.visible&&(this.style=null,this.$nextTick(function(){var e=s.$refs.Input.getBoundingClientRect(),t=s.$refs.Drop,a={bottom:""};if(s.transfer)if(a.left=e.left+"px",e.bottom+t.offsetHeight+5>=window.innerHeight){var i=e.top-t.offsetHeight-10;i<0?a.top=e.bottom+"px":(a.top=i+"px",a.bottom=window.innerHeight-e.top+"px")}else a.top=e.bottom+"px";else a={left:0,top:e.height+"px"};s.style=a}))},hide:function(){this.visible&&(this.visible=!1)},init:function(e){var t=this;if(e){var a="";switch(e){case"c":a=this.select.province.code;break;case"a":a=this.select.city.code,this.areas=this.areaInfoList.filter(function(e){return e.cityCode===a&&e.name})}}else this.provinceInfoList.sort(function(e,t){var a=h.commonFunc.getNamePinYin(e.province),i=h.commonFunc.getNamePinYin(t.province);return e.province.includes("重庆")&&(a="chongqingshi"),t.province.includes("重庆")&&(i="chongqingshi"),e.fstCh=a[0],t.fstCh=i[0],i<a?1:-1}).forEach(function(e){"a"<=e.fstCh&&e.fstCh<="g"&&t.provinces["A-G"].push(e),"h"<=e.fstCh&&e.fstCh<="k"&&t.provinces["H-K"].push(e),"l"<=e.fstCh&&e.fstCh<="s"&&t.provinces["L-S"].push(e),"t"<=e.fstCh&&e.fstCh<="z"&&t.provinces["T-Z"].push(e)})},listProvince:function(){var t=this;g.a.post("getProvinceList").then(function(e){e.success?(t.provinceInfoList=e.data?e.data:[],t.init()):t.provinceInfoList=[]})},queryCityInfoList:function(e){var t=this;g.a.post("getCityList",{provinceid:e}).then(function(e){e.success?(t.cityInfoList=e.data?e.data:[],t.cityInfoList.length?(t.init("c"),t.view="c"):(t.select.city=t.select.area=null,t.callback(),t.hide())):t.cityInfoList=[]})},getSysAreassByCityid:function(e){var t=this;g.a.post("getAreaList",{cityid:e}).then(function(e){e.success?(t.areaInfoList=e.data?e.data:[],t.init("a"),t.areaInfoList.length?t.view="a":(t.select.area=null,t.callback(),t.hide())):t.areaInfoList=[]})},setDefaultValue:function(){this.defaultValue.province&&(this.select.province=this.defaultValue.province),this.defaultValue.city&&(this.select.city=this.defaultValue.city),this.defaultValue.area&&(this.select.area=this.defaultValue.area),this.curVal=this.select.value=(this.select.province&&this.select.province.province||"")+(this.select.city&&this.select.city.city||"")+(this.select.area&&this.select.area.area||"")}},created:function(){this.listProvince()},mounted:function(){var a=this,t=document.onmousedown;document.onmousedown=function(e){t&&t(e),a.hide()};var i=window.onresize;(window.onresize=function(e){i&&i(e),a.setPos()},this.transfer)&&y.getAllHasScrollParentEls(this.$refs.Input).forEach(function(e){var t=e.onscroll;e.onscroll=function(e){t&&t(e),a.setPos()}})},watch:{defaultValue:{handler:function(e,t){this.setDefaultValue()},deep:!0,immediate:!0}}},C={render:function(){var e,i=this,t=i.$createElement,s=i._self._c||t;return s("div",{staticClass:"klwk-city-select"},[s("div",{ref:"Input",staticClass:"klwk-city-select-input",class:{disabled:i.disabled},on:{mouseenter:function(e){i.hovering=!0},mouseleave:function(e){i.hovering=!1},mousedown:function(e){e.stopPropagation()},click:function(e){i.onClickInput(e)}}},[s("input",{directives:[{name:"model",rawName:"v-model",value:i.curVal,expression:"curVal"}],attrs:{type:"text",readonly:"",placeholder:i.placeholder},domProps:{value:i.curVal},on:{input:function(e){e.target.composing||(i.curVal=e.target.value)}}}),i._v(" "),s("div",{staticClass:"suffix",on:{click:function(e){i.onClickSuffix(e)}}},[i.iconClearShow?s("span",{staticClass:"icon-clear el-icon-circle-close"}):s("span",{staticClass:"iconfont icon-arrow-down",class:{visible:i.visible}})])]),i._v(" "),s("transition",{attrs:{name:"klwk-dropdown"}},[s("div",{directives:[{name:"transfer-dom",rawName:"v-transfer-dom"},{name:"show",rawName:"v-show",value:i.visible,expression:"visible"}],ref:"Drop",staticClass:"klwk-cityselect-dropdown",style:i.style,attrs:{"data-transfer":i.transfer},on:{mousedown:function(e){e.stopPropagation()}}},[s("div",{staticClass:"data-tabs clearfix"},[s("div",{staticClass:"tab",class:{active:"p"===i.view},on:{click:function(e){i.view="p"}}},[i._v("省份")]),i._v(" "),"a,c".includes(i.type)?s("div",{staticClass:"tab",class:{active:"c"===i.view},on:{click:function(e){i.view="c"}}},[i._v("\n                    城市\n                ")]):i._e(),i._v(" "),"a"===i.type?s("div",{staticClass:"tab",class:{active:"a"===i.view},on:{click:function(e){i.view="a"}}},[i._v("区域")]):i._e()]),i._v(" "),s("div",{staticClass:"data-container clearfix",class:(e={},e[i.view]=!0,e)},[i._l(i.provinces,function(e,a){return s("div",{directives:[{name:"show",rawName:"v-show",value:"p"===i.view,expression:"view === 'p'"}],key:a,staticClass:"p-section"},[s("div",{staticClass:"p-key"},[i._v(i._s(a))]),i._v(" "),s("div",{staticClass:"p-container clearfix"},i._l(e,function(t,e){return s("div",{key:e+a,staticClass:"select-item",on:{click:function(e){i.onClickItem(t)}}},[s("div",{directives:[{name:"w-title",rawName:"v-w-title",value:t.province,expression:"item.province"}],class:{active:i.select.province&&i.select.province.provinceid===t.provinceid}},[i._v("\n                                "+i._s(t.province)+"\n                            ")])])}))])}),i._v(" "),i._l(i.cityInfoList,function(t,e){return s("div",{directives:[{name:"show",rawName:"v-show",value:"c"===i.view,expression:"view === 'c'"}],key:e+"c",staticClass:"select-item c",on:{click:function(e){i.onClickItem(t)}}},[s("div",{directives:[{name:"w-title",rawName:"v-w-title",value:t.city,expression:"item.city"}],class:{active:i.select.city&&i.select.city.cityid===t.cityid}},[i._v("\n                        "+i._s(t.city)+"\n                    ")])])}),i._v(" "),i._l(i.areaInfoList,function(t,e){return s("div",{directives:[{name:"show",rawName:"v-show",value:"a"===i.view,expression:"view === 'a'"}],key:e+"a",staticClass:"select-item a",on:{click:function(e){i.onClickItem(t)}}},[s("div",{directives:[{name:"w-title",rawName:"v-w-title",value:t.area,expression:"item.area"}],class:{active:i.select.area&&i.select.area.areaid===t.areaid}},[i._v("\n                        "+i._s(t.area)+"\n                    ")])])})],2)])])],1)},staticRenderFns:[]};var _=a("VU/8")(D,C,!1,function(e){a("lmcD")},null,null).exports,b={components:{cityPlugin:_},props:{value:{type:Boolean,default:!1},"chosed-node-detail":{type:Object,default:function(){return{}}},"added-node-detail":{type:Object,default:function(){return{}}},"root-id":{type:String,default:""}},data:function(){var i=this;return{formData:{phone:"",fianceSuperior:"",manageSuperior:"",fax:"",companyCode:"",controlAccount:"",mail:"",smsProvider:"",address:"",place:{},person:""},ruleValidate:{phone:[{validator:function(e,t,a){t?h.validator.isMobile(t)||h.validator.isTelephone(t)?a():a(i.$t("errorFormat",{field:i.$t("phone")})):a()},trigger:"blur"},{max:20,message:this.$t("errorMaxLength",{field:this.$t("phone"),length:20}),trigger:"blur"}],fax:[{validator:function(e,t,a){t?h.validator.isMobile(t)||h.validator.isTelephone(t)?a():a(i.$t("errorFormat",{field:i.$t("fax")})):a()},trigger:"blur"},{max:20,message:this.$t("errorMaxLength",{field:this.$t("fax"),length:20}),trigger:"blur"}],fianceSuperior:[{required:!0,message:this.$t("inputField",{field:this.$t("fianceSuperior")}),trigger:"change"}],controlAccount:[{required:!0,validator:function(e,t,a){t?i.queryAccountExist().then(function(e){e.success?e.data?a():a("管理账号已存在"):a("账号校验失败")}).catch(function(){a("管理账号已存在")}):a(i.$t("inputField",{field:i.$t("controlAccount")}))},trigger:"blur"},{max:20,message:this.$t("errorMaxLength",{field:this.$t("controlAccount"),length:20}),trigger:"blur"}],mail:[{required:!0,validator:function(e,t,a){t?h.validator.isEmail(t)?a():a(i.$t("errorFormat",{field:i.$t("email")})):a(i.$t("inputField",{field:i.$t("email")}))},trigger:"blur"},{max:100,message:this.$t("errorMaxLength",{field:this.$t("email"),length:100}),trigger:"blur"}],smsProvider:[{required:!0,message:this.$t("selectField",{msg:this.$t("smsProvider")}),trigger:"change"}],person:[{required:!0,message:this.$t("inputField",{field:this.$t("person")})},{max:10,message:this.$t("errorMaxLength",{field:this.$t("person"),length:10}),trigger:"blur"}],companyCode:[{min:2,max:8,message:this.$t("rangeError",{field:this.$t("companyCode"),min:2,max:8}),trigger:"blur"}],address:[{max:100,message:this.$t("errorMaxLength",{field:this.$t("address"),length:100}),trigger:"blur"}]},smsProviderList:[],parentEconomics:[],parentManages:[],savIng:!1}},watch:{chosedNodeDetail:{handler:function(e,t){e&&0<s()(e).length&&(this.formData.fianceSuperior=e.id,this.formData.manageSuperior=e.id)},immediate:!0}},methods:{changeValue:function(e){this.$emit("input",e)},visibleChange:function(e){!1===e?(this.resetFormData(),this.$refs.formValidate.resetFields()):(this.getParentManages(),this.getParentEconomic(),this.querySmsProviderList(),this.formData.fianceSuperior=this.chosedNodeDetail.id,this.formData.manageSuperior=this.chosedNodeDetail.id)},save:function(){var t=this;this.savIng=!0,this.$refs.formValidate.validate(function(e){e?t.addOrgInfo():t.savIng=!1})},resetFormData:function(){for(var e in this.formData)this.formData[e]=""},addCompany:function(){this.$emit("fresh-structure-data"),this.$emit("input",!1)},cancel:function(){this.$emit("input",!1)},getParentManages:function(){var t=this;g.a.post("getOrgsByManageType",{orgId:this.chosedNodeDetail.id,manageType:"manage",nodeType:this.chosedNodeDetail.nodeType}).then(function(e){e.success?t.parentManages=e.data?e.data:[]:t.parentManages=[]})},getParentEconomic:function(){var t=this;g.a.post("getOrgsByManageType",{orgId:this.chosedNodeDetail.id,manageType:"economic",nodeType:this.chosedNodeDetail.nodeType}).then(function(e){e.success?t.parentEconomics=e.data?e.data:[]:t.parentEconomics=[]})},querySmsProviderList:function(){var t=this;g.a.post("getSmsProviderList").then(function(e){e.success?t.smsProviderList=e.data?e.data:[]:t.smsProviderList=[]})},addOrgInfo:function(){var t=this;g.a.post("addOrgInfo",{orgName:this.addedNodeDetail.nodeName,loginName:this.formData.controlAccount,email:this.formData.mail,smsProvider:this.formData.smsProvider,linkName:this.formData.person,telephone:this.formData.phone,tex:this.formData.fax,checkinCode:this.formData.companyCode,province:this.placeInfo.provinceid,city:this.placeInfo.cityid,district:this.placeInfo.areaid,address:this.formData.address,parentEconomicId:this.formData.fianceSuperior,parentManageId:this.formData.manageSuperior,nodeType:"company"}).then(function(e){e.success?(t.$emit("fresh-structure-data"),t.$emit("input",!1),t.$Message.success("新增成功")):t.$Message.error(e.message||"新增失败")}).finally(function(){t.savIng=!1})},queryAccountExist:function(){return g.a.post("checkLoginNameUnique",{loginName:this.formData.controlAccount})},changeCity:function(e){this.formData.place=e}},computed:{placeInfo:function(){var e={};return this.formData.place?(this.formData.place.province?e.provinceid=this.formData.place.province.provinceid:e.provinceid="",this.formData.place.city?e.cityid=this.formData.place.city.cityid:e.cityid="",this.formData.place.area?e.areaid=this.formData.place.area.areaid:e.areaid="",e):{provinceid:"",cityid:"",areaid:""}}}},w={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Modal",{staticClass:"add-company",attrs:{title:"Title","mask-closable":!1,value:t.value,"class-name":"vertical-center-modal"},on:{input:t.changeValue,"on-visible-change":t.visibleChange}},[a("div",{staticClass:"target-class",attrs:{slot:"header"},slot:"header"},[a("span",{directives:[{name:"w-title",rawName:"v-w-title",value:t.addedNodeDetail.nodeName,expression:"addedNodeDetail.nodeName"}],staticClass:"title"},[t._v(t._s(t.addedNodeDetail.nodeName))])]),t._v(" "),a("div",{staticClass:"target-body"},[a("Form",{ref:"formValidate",attrs:{model:t.formData,rules:t.ruleValidate,"label-width":190}},[a("FormItem",{attrs:{label:t.$t("fianceSuperior"),prop:"fianceSuperior"}},[a("Select",{staticStyle:{width:"280px"},model:{value:t.formData.fianceSuperior,callback:function(e){t.$set(t.formData,"fianceSuperior",e)},expression:"formData.fianceSuperior"}},t._l(t.parentEconomics,function(e){return a("Option",{key:e.id,attrs:{value:e.id}},[t._v("\n                        "+t._s(e.orgName)+"\n                    ")])}))],1),t._v(" "),a("FormItem",{attrs:{label:t.$t("manageSuperior"),required:""}},[a("Select",{staticStyle:{width:"280px"},attrs:{disabled:""},model:{value:t.formData.manageSuperior,callback:function(e){t.$set(t.formData,"manageSuperior",e)},expression:"formData.manageSuperior"}},t._l(t.parentManages,function(e){return a("Option",{key:e.id,attrs:{value:e.id}},[t._v("\n                        "+t._s(e.orgName)+"\n                    ")])}))],1),t._v(" "),a("FormItem",{attrs:{label:t.$t("controlAccount"),prop:"controlAccount"}},[a("Input",{staticStyle:{width:"280px"},model:{value:t.formData.controlAccount,callback:function(e){t.$set(t.formData,"controlAccount","string"==typeof e?e.trim():e)},expression:"formData.controlAccount"}})],1),t._v(" "),a("FormItem",{attrs:{label:t.$t("email"),prop:"mail"}},[a("Input",{staticStyle:{width:"280px"},model:{value:t.formData.mail,callback:function(e){t.$set(t.formData,"mail","string"==typeof e?e.trim():e)},expression:"formData.mail"}})],1),t._v(" "),a("FormItem",{attrs:{label:t.$t("smsProvider"),prop:"smsProvider"}},[a("Select",{staticStyle:{width:"280px"},model:{value:t.formData.smsProvider,callback:function(e){t.$set(t.formData,"smsProvider","string"==typeof e?e.trim():e)},expression:"formData.smsProvider"}},t._l(t.smsProviderList,function(e){return a("Option",{key:e.desc,attrs:{value:e.desc}},[t._v("\n                        "+t._s(e.desc)+"\n                    ")])}))],1),t._v(" "),a("FormItem",{attrs:{label:t.$t("person"),prop:"person"}},[a("Input",{staticStyle:{width:"280px"},model:{value:t.formData.person,callback:function(e){t.$set(t.formData,"person","string"==typeof e?e.trim():e)},expression:"formData.person"}})],1),t._v(" "),a("FormItem",{attrs:{label:t.$t("phone"),prop:"phone"}},[a("Input",{staticStyle:{width:"280px"},model:{value:t.formData.phone,callback:function(e){t.$set(t.formData,"phone","string"==typeof e?e.trim():e)},expression:"formData.phone"}})],1),t._v(" "),a("FormItem",{attrs:{label:t.$t("fax"),prop:"fax"}},[a("Input",{staticStyle:{width:"280px"},model:{value:t.formData.fax,callback:function(e){t.$set(t.formData,"fax",e)},expression:"formData.fax"}})],1),t._v(" "),a("FormItem",{attrs:{prop:"companyCode"}},[a("template",{slot:"label"},[a("Tooltip",{attrs:{placement:"top",transfer:""}},[a("div",{staticClass:"tips-content",attrs:{slot:"content"},slot:"content"},[t._v("\n                            用于与线下系统对接\n                        ")]),t._v(" "),a("span",{staticClass:"iconfont icon-note"})]),t._v(" "),a("span",[t._v(t._s(t.$t("enterpriseCode")+"("+t.$t("offlineVerify")+")")+"：")])],1),t._v(" "),a("Input",{staticStyle:{width:"280px"},model:{value:t.formData.companyCode,callback:function(e){t.$set(t.formData,"companyCode","string"==typeof e?e.trim():e)},expression:"formData.companyCode"}})],2),t._v(" "),a("FormItem",{attrs:{label:t.$t("location")}},[t.value?a("city-plugin",{staticStyle:{width:"280px"},on:{select:t.changeCity}}):t._e()],1),t._v(" "),a("FormItem",{attrs:{label:t.$t("address"),prop:"address"}},[a("Input",{staticStyle:{width:"280px"},model:{value:t.formData.address,callback:function(e){t.$set(t.formData,"address","string"==typeof e?e.trim():e)},expression:"formData.address"}})],1)],1)],1),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{staticClass:"ivu-btn-90px",attrs:{type:"ghost"},on:{click:t.cancel}},[t._v("取消")]),t._v(" "),a("Button",{staticClass:"ivu-btn-90px",attrs:{type:"primary",loading:t.savIng},on:{click:t.save}},[t._v("保存")])],1)])},staticRenderFns:[]};var S=a("VU/8")(b,w,!1,function(e){a("A+Aw")},"data-v-6980b886",null).exports,N={components:{cityPlugin:_},props:{value:{type:Boolean,default:!1},"chosed-node-detail":{type:Object,default:function(){return{}}},"added-node-detail":{type:Object,default:function(){return{}}},"root-id":{type:String,default:""}},data:function(){var i=this;return{formData:{phone:"",fianceSuperior:"",manageSuperior:"",openedServices:[],fax:"",companyCode:"",controlAccount:"",mail:"",address:"",place:{},person:""},ruleValidate:{phone:[{validator:function(e,t,a){t?h.validator.isMobile(t)||h.validator.isTelephone(t)?a():a(i.$t("errorFormat",{field:i.$t("phone")})):a()},trigger:"blur"},{max:20,message:this.$t("errorMaxLength",{field:this.$t("phone"),length:20}),trigger:"blur"}],fax:[{validator:function(e,t,a){t?h.validator.isMobile(t)||h.validator.isTelephone(t)?a():a(i.$t("errorFormat",{field:i.$t("fax")})):a()},trigger:"blur"},{max:20,message:this.$t("errorMaxLength",{field:this.$t("fax"),length:20}),trigger:"blur"}],fianceSuperior:[{required:!0,message:this.$t("selectField",{msg:this.$t("fianceSuperior")}),trigger:"change"}],manageSuperior:[{required:!0,message:this.$t("selectField",{msg:this.$t("manageSuperior")}),trigger:"change"}],controlAccount:[{required:!0,validator:function(e,t,a){t?i.queryAccountExist().then(function(e){e.success?e.data?a():a("管理账号已存在"):a("账号校验失败")}).catch(function(){a("管理账号已存在")}):a(i.$t("inputField",{field:i.$t("controlAccount")}))},trigger:"blur"},{max:20,message:this.$t("errorMaxLength",{field:this.$t("controlAccount"),length:20}),trigger:"blur"}],mail:[{required:!0,validator:function(e,t,a){t?h.validator.isEmail(t)?a():a(i.$t("errorFormat",{field:i.$t("email")})):a(i.$t("inputField",{field:i.$t("email")}))},trigger:"blur"},{max:100,message:this.$t("errorMaxLength",{field:this.$t("email"),length:100}),trigger:"blur"}],person:[{required:!0,message:this.$t("inputField",{field:this.$t("person")}),trigger:"blur"},{max:10,message:this.$t("errorMaxLength",{field:this.$t("person"),length:10}),trigger:"blur"}],address:[{max:100,message:this.$t("errorMaxLength",{field:this.$t("address"),length:100}),trigger:"blur"}],companyCode:[{min:2,max:8,message:this.$t("rangeError",{field:this.$t("companyCode"),min:2,max:8}),trigger:"blur"}]},fianceSuperiorList:[],serviceList:[],manageSuperiorList:[],saveIng:!1}},watch:{chosedNodeDetail:{handler:function(e,t){e&&0<s()(e).length&&(this.formData.manageSuperior=e.id,this.formData.fianceSuperior=e.id)},immediate:!0}},methods:{changeValue:function(e){this.$emit("input",e)},visibleChange:function(e){!1===e?(this.resetFormData(),this.$refs.formValidate.resetFields()):(this.getParentManages(),this.getParentEconomic(),this.getOrgServiceList())},save:function(){var t=this;this.saveIng=!0,this.$refs.formValidate.validate(function(e){e?t.addCompany():t.saveIng=!1})},resetFormData:function(){for(var e in this.formData)this.formData[e]=""},addCompany:function(){var t=this;g.a.post("addOrgInfo",{orgName:this.addedNodeDetail.nodeName,loginName:this.formData.controlAccount,email:this.formData.mail,linkName:this.formData.person,telephone:this.formData.phone,tex:this.formData.fax,checkinCode:this.formData.companyCode,province:this.placeInfo.provinceid,city:this.placeInfo.cityid,district:this.placeInfo.areaid,address:this.formData.address,parentEconomicId:this.formData.fianceSuperior,parentManageId:this.formData.manageSuperior,nodeType:"scenic",openService:this.formData.openedServices.join(",")}).then(function(e){e.success?(t.$emit("fresh-structure-data"),t.$Message.success("新增成功")):t.$Message.error("新增失败"|e.message)}).finally(function(){t.$emit("input",!1),t.saveIng=!1})},cancel:function(){this.$emit("input",!1)},getParentManages:function(){var t=this;g.a.post("getOrgsByManageType",{orgId:this.chosedNodeDetail.id,manageType:"manage",nodeType:this.chosedNodeDetail.nodeType}).then(function(e){e.success?t.manageSuperiorList=e.data?e.data:[]:t.manageSuperiorList=[]})},getParentEconomic:function(){var t=this;g.a.post("getOrgsByManageType",{orgId:this.chosedNodeDetail.id,manageType:"economic",nodeType:this.chosedNodeDetail.nodeType}).then(function(e){e.success?t.fianceSuperiorList=e.data?e.data:[]:t.fianceSuperiorList=[]})},queryAccountExist:function(){return g.a.post("checkLoginNameUnique",{loginName:this.formData.controlAccount})},getOrgServiceList:function(){var t=this;g.a.post("getOrgServiceList",{orgId:this.chosedNodeDetail.id,pageNo:1,pageSize:9999}).then(function(e){e.success?t.serviceList=e.data&&e.data.rootServiceList?e.data.rootServiceList.data:[]:t.serviceList=[]})},changeCity:function(e){this.formData.place=e}},computed:{placeInfo:function(){var e={};return this.formData.place?(this.formData.place.province?e.provinceid=this.formData.place.province.provinceid:e.provinceid="",this.formData.place.city?e.cityid=this.formData.place.city.cityid:e.cityid="",this.formData.place.area?e.areaid=this.formData.place.area.areaid:e.areaid="",e):{provinceid:"",cityid:"",areaid:""}}}},k={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Modal",{staticClass:"add-scene",attrs:{title:"Title","mask-closable":!1,value:t.value,"class-name":"vertical-center-modal"},on:{input:t.changeValue,"on-visible-change":t.visibleChange}},[a("div",{staticClass:"target-class",attrs:{slot:"header"},slot:"header"},[a("span",{directives:[{name:"w-title",rawName:"v-w-title",value:t.addedNodeDetail.nodeName,expression:"addedNodeDetail.nodeName"}],staticClass:"title"},[t._v(t._s(t.addedNodeDetail.nodeName))])]),t._v(" "),a("div",{staticClass:"target-body"},[a("Form",{ref:"formValidate",attrs:{model:t.formData,rules:t.ruleValidate,"label-width":190}},[a("FormItem",{attrs:{label:t.$t("fianceSuperior"),prop:"fianceSuperior"}},[a("Select",{staticStyle:{width:"280px"},model:{value:t.formData.fianceSuperior,callback:function(e){t.$set(t.formData,"fianceSuperior",e)},expression:"formData.fianceSuperior"}},t._l(t.fianceSuperiorList,function(e){return a("Option",{key:e.id,attrs:{value:e.id}},[t._v("\n                        "+t._s(e.orgName)+"\n                    ")])}))],1),t._v(" "),a("FormItem",{attrs:{label:t.$t("manageSuperior"),prop:"manageSuperior"}},[a("Select",{staticStyle:{width:"280px"},attrs:{disabled:""},model:{value:t.formData.manageSuperior,callback:function(e){t.$set(t.formData,"manageSuperior",e)},expression:"formData.manageSuperior"}},t._l(t.manageSuperiorList,function(e){return a("Option",{key:e.id,attrs:{value:e.id}},[t._v("\n                        "+t._s(e.orgName)+"\n                    ")])}))],1),t._v(" "),a("FormItem",{attrs:{prop:"openedServices"}},[a("template",{slot:"label"},[a("Tooltip",{attrs:{placement:"top",transfer:""}},[a("div",{staticClass:"tips-content",attrs:{slot:"content"},slot:"content"},[t._v("\n                            如需开通更多服务，请先为上级公司开通相应服务。\n                        ")]),t._v(" "),a("span",{staticClass:"iconfont icon-note"})]),t._v(" "),a("span",[t._v(t._s(t.$t("openedServices"))+"：")])],1),t._v(" "),a("CheckboxGroup",{model:{value:t.formData.openedServices,callback:function(e){t.$set(t.formData,"openedServices",e)},expression:"formData.openedServices"}},t._l(t.serviceList,function(e){return a("Checkbox",{key:e.id,attrs:{label:e.id}},[t._v("\n                        "+t._s(e.serviceName)+"\n                    ")])}))],2),t._v(" "),a("FormItem",{attrs:{label:t.$t("controlAccount"),prop:"controlAccount"}},[a("Input",{staticStyle:{width:"280px"},model:{value:t.formData.controlAccount,callback:function(e){t.$set(t.formData,"controlAccount","string"==typeof e?e.trim():e)},expression:"formData.controlAccount"}})],1),t._v(" "),a("FormItem",{attrs:{label:t.$t("email"),prop:"mail"}},[a("Input",{staticStyle:{width:"280px"},model:{value:t.formData.mail,callback:function(e){t.$set(t.formData,"mail","string"==typeof e?e.trim():e)},expression:"formData.mail"}})],1),t._v(" "),a("FormItem",{attrs:{label:t.$t("person"),prop:"person"}},[a("Input",{staticStyle:{width:"280px"},model:{value:t.formData.person,callback:function(e){t.$set(t.formData,"person","string"==typeof e?e.trim():e)},expression:"formData.person"}})],1),t._v(" "),a("FormItem",{attrs:{label:t.$t("phone"),prop:"phone"}},[a("Input",{staticStyle:{width:"280px"},model:{value:t.formData.phone,callback:function(e){t.$set(t.formData,"phone","string"==typeof e?e.trim():e)},expression:"formData.phone"}})],1),t._v(" "),a("FormItem",{attrs:{label:t.$t("fax"),prop:"fax"}},[a("Input",{staticStyle:{width:"280px"},model:{value:t.formData.fax,callback:function(e){t.$set(t.formData,"fax","string"==typeof e?e.trim():e)},expression:"formData.fax"}})],1),t._v(" "),a("FormItem",{attrs:{prop:"companyCode"}},[a("template",{slot:"label"},[a("Tooltip",{attrs:{placement:"top",transfer:""}},[a("div",{staticClass:"tips-content",attrs:{slot:"content"},slot:"content"},[t._v("\n                            用于与线下系统对接\n                        ")]),t._v(" "),a("span",{staticClass:"iconfont icon-note"})]),t._v(" "),a("span",[t._v(t._s(t.$t("companyCode")+"("+t.$t("offlineVerify")+")")+"：")])],1),t._v(" "),a("Input",{staticStyle:{width:"280px"},model:{value:t.formData.companyCode,callback:function(e){t.$set(t.formData,"companyCode","string"==typeof e?e.trim():e)},expression:"formData.companyCode"}})],2),t._v(" "),a("FormItem",{attrs:{label:t.$t("location")}},[t.value?a("city-plugin",{staticStyle:{width:"280px"},on:{select:t.changeCity}}):t._e()],1),t._v(" "),a("FormItem",{attrs:{label:t.$t("address"),prop:"address"}},[a("Input",{staticStyle:{width:"280px"},model:{value:t.formData.address,callback:function(e){t.$set(t.formData,"address",e)},expression:"formData.address"}})],1)],1)],1),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{staticClass:"ivu-btn-90px",attrs:{type:"ghost"},on:{click:t.cancel}},[t._v("取消")]),t._v(" "),a("Button",{staticClass:"ivu-btn-90px",attrs:{type:"primary",loading:t.saveIng},on:{click:t.save}},[t._v("保存")])],1)])},staticRenderFns:[]};var $=a("VU/8")(N,k,!1,function(e){a("4GeM")},"data-v-7d35bb5a",null).exports,x={components:{cityPlugin:_},props:{value:{type:Boolean,default:!1},"chosed-node-detail":{type:Object,default:function(){return{}}},"added-node-detail":{type:Object,default:function(){return{}}}},data:function(){var i=this;return{formData:{cashierType:"",cashierTypeGroup:"",serverName:"",smsProvider:"",saleTypeGroup:""},ruleValidate:{cashierType:[{required:!0,message:this.$t("selectField",{msg:this.$t("cashierType")}),trigger:"change"}],serverName:[{required:!0,message:this.$t("inputField",{field:this.$t("serverName")}),trigger:"blur"},{required:!0,validator:function(e,t,a){t?i.checkServerUrlUnique(t).then(function(e){e.success?e.data?a():a("服务器名称已存在"):a("服务器名称校验失败")}):a(i.$t("inputField",{field:i.$t("serverName")}))},trigger:"blur"},{max:50,message:this.$t("errorMaxLength",{field:this.$t("serverName"),length:50}),trigger:"blur"}],smsProvider:[{required:!0,message:this.$t("selectField",{msg:this.$t("smsProvider")}),trigger:"change"}],cashierTypeGroup:[{message:this.$t("selectField",{msg:this.$t("cashierTypeGroup")}),trigger:"change"}],saleTypeGroup:[{message:this.$t("selectField",{msg:this.$t("saleTypeGroup")}),trigger:"change"}]},cashierTypeList:p.d,cashierTypeGroupList:[],saleTypeGroupList:[],saveIng:!1}},watch:{chosedNodeDetail:{handler:function(e,t){e&&0<s()(e).length&&(this.formData.fianceSuperior=e.title)},immediate:!0}},methods:{changeValue:function(e){this.$emit("input",e)},visibleChange:function(e){!1===e?(this.resetFormData(),this.$refs.formValidate.resetFields()):(this.getCheckItemPage(),this.getSaleItemPage())},save:function(){var t=this;this.saveIng=!0,this.$refs.formValidate.validate(function(e){e?t.addCashier():t.saveIng=!1})},resetFormData:function(){for(var e in this.formData)this.formData[e]=""},addCashier:function(){var t=this;g.a.post("addOrgInfo",{orgName:this.addedNodeDetail.nodeName,nodeType:"table",checkerType:this.formData.cashierType,saleGroupId:this.formData.saleTypeGroup,checkGroupId:this.formData.cashierTypeGroup,serverUrl:this.formData.serverName,parentManageId:this.chosedNodeDetail.id,parentEconomicId:this.chosedNodeDetail.id}).then(function(e){e.success?(t.$emit("fresh-structure-data"),t.$Message.success("新增成功")):t.$Message.error("新增失败")}).finally(function(){t.saveIng=!1,t.$emit("input",!1)})},cashierTypeChange:function(e){console.log(e)},cancel:function(){this.$emit("input",!1)},getCheckItemPage:function(){var t=this;g.a.post("getOrgGroupList",{groupType:"check",orgId:this.chosedNodeDetail.id}).then(function(e){e.success?t.cashierTypeGroupList=e.data?e.data:[]:t.cashierTypeGroupList=[]})},getSaleItemPage:function(){var t=this;g.a.post("getOrgGroupList",{groupType:"sale",orgId:this.chosedNodeDetail.id}).then(function(e){e.success?t.saleTypeGroupList=e.data?e.data:[]:t.saleTypeGroupList=[]})},checkServerUrlUnique:function(e){return g.a.post("checkServerUrlUnique",{serverUrl:e})}},computed:{showCashierTypeGroup:function(){return!this.formData.cashierType||("check"===this.formData.cashierType||"combine"===this.formData.cashierType)},showSaleTypeGroup:function(){return!this.formData.cashierType||("sale"===this.formData.cashierType||"combine"===this.formData.cashierType)}}},I={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Modal",{staticClass:"add-cashier",attrs:{title:"Title","mask-closable":!1,value:t.value,"class-name":"vertical-center-modal"},on:{input:t.changeValue,"on-visible-change":t.visibleChange}},[a("div",{staticClass:"target-class",attrs:{slot:"header"},slot:"header"},[a("span",{directives:[{name:"w-title",rawName:"v-w-title",value:t.addedNodeDetail.nodeName,expression:"addedNodeDetail.nodeName"}],staticClass:"title"},[t._v(t._s(t.addedNodeDetail.nodeName))])]),t._v(" "),a("div",{staticClass:"target-body"},[a("Form",{ref:"formValidate",attrs:{model:t.formData,rules:t.ruleValidate,"label-width":180}},[a("FormItem",{attrs:{prop:"serverName"}},[a("template",{slot:"label"},[a("Tooltip",{attrs:{placement:"top",transfer:""}},[a("div",{staticClass:"tips-content",attrs:{slot:"content"},slot:"content"},[t._v("\n                            服务器名称为景区编码+设备编码或内网IP地址，不可重复\n                        ")]),t._v(" "),a("span",{staticClass:"iconfont icon-note"})]),t._v(" "),a("span",[t._v("服务器名称：")])],1),t._v(" "),a("Input",{staticStyle:{width:"280px"},model:{value:t.formData.serverName,callback:function(e){t.$set(t.formData,"serverName","string"==typeof e?e.trim():e)},expression:"formData.serverName"}})],2),t._v(" "),a("FormItem",{attrs:{label:t.$t("cashierType"),prop:"cashierType"}},[a("Select",{staticStyle:{width:"280px"},on:{"on-change":t.cashierTypeChange},model:{value:t.formData.cashierType,callback:function(e){t.$set(t.formData,"cashierType",e)},expression:"formData.cashierType"}},t._l(t.cashierTypeList,function(e){return a("Option",{key:e.value,attrs:{value:e.value}},[t._v("\n                        "+t._s(t.$t(e.label))+"\n                    ")])}))],1),t._v(" "),t.showCashierTypeGroup?a("FormItem",{attrs:{label:t.$t("cashierTypeGroup"),prop:"cashierTypeGroup"}},[a("Select",{staticStyle:{width:"280px"},attrs:{clearable:!0,transfer:""},model:{value:t.formData.cashierTypeGroup,callback:function(e){t.$set(t.formData,"cashierTypeGroup",e)},expression:"formData.cashierTypeGroup"}},t._l(t.cashierTypeGroupList,function(e){return a("Option",{directives:[{name:"w-title",rawName:"v-w-title",value:e.groupName,expression:"item.groupName"}],key:e.id,staticClass:"overflow-tip",attrs:{value:e.id}},[t._v("\n                        "+t._s(t.$t(e.groupName))+"\n                    ")])}))],1):t._e(),t._v(" "),t.showSaleTypeGroup?a("FormItem",{attrs:{label:t.$t("saleTypeGroup"),transfer:"",prop:"saleTypeGroup"}},[a("Select",{staticStyle:{width:"280px"},attrs:{clearable:!0,transfer:""},model:{value:t.formData.saleTypeGroup,callback:function(e){t.$set(t.formData,"saleTypeGroup",e)},expression:"formData.saleTypeGroup"}},t._l(t.saleTypeGroupList,function(e){return a("Option",{directives:[{name:"w-title",rawName:"v-w-title",value:e.groupName,expression:"item.groupName"}],key:e.id,staticClass:"overflow-tip",attrs:{value:e.id}},[t._v("\n                        "+t._s(e.groupName)+"\n                    ")])}))],1):t._e()],1)],1),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{staticClass:"ivu-btn-90px",attrs:{type:"ghost"},on:{click:t.cancel}},[t._v("取消")]),t._v(" "),a("Button",{staticClass:"ivu-btn-90px",attrs:{type:"primary",loading:t.saveIng},on:{click:t.save}},[t._v("保存")])],1)])},staticRenderFns:[]};var T=a("VU/8")(x,I,!1,function(e){a("oBZ+")},"data-v-22363894",null).exports,F=a("qwrG"),P={props:{"tree-data":{type:Object,default:function(){return{}}},value:{type:String,default:""},activeNode:{type:Object,default:function(){return{}}}},components:{delModal:c.a,addModal:f,addCompany:S,addScene:$,addCashier:T,noData:F.a,editModal:d.a},data:function(){return{keyWord:"",activeTap:"manage",addModalShow:!1,currentNode:{},addCompanyModalShow:!1,addSceneModalShow:!1,addCashierModalShow:!1,addNodeDetail:{},defaultProps:{children:"subNodes"}}},methods:{renderContent:function(e,t){var a=this,i=(t.root,t.node),s=t.data;return s.id===this.activeNode.id&&this.$emit("update:activeNode",l()(this.activeNode,{level:i.level})),e("div",{style:{display:"inline-block",width:"100%"},class:{"title-wrap":!0,"active-node":s.id===this.activeNode.id},on:{click:function(){a.$emit("update:activeNode",{id:s.id,level:i.level,type:s.nodeType}),a.$emit("input",s.nodeType)}}},[e("span",{class:{"title-class":!0},directives:[{name:"w-title",value:s.orgName}]},s.orgName),e("span",{class:{iconfont:"true","icon-delete":!0,hidden:"economic"===this.activeTap||1===i.level},style:{paddingRight:"5px",color:"#EB6751",fontSize:"14px",marginTop:"10px"},on:{click:function(e){e.stopPropagation(),a.currentNode=s,a.$refs.delModal.show({title:"删除"+s.orgName,confirmCallback:function(){a.delNode(s)}})}}}),e("span",{class:{iconfont:"true","icon-node-add":!0,hidden:"economic"===this.activeTap||"department"===s.nodeType||"table"===s.nodeType},style:{paddingRight:"5px",fontSize:"16px"},on:{click:function(e){e.stopPropagation(),a.currentNode=s,a.addModalShow=!0}}})])},switchTap:function(e){this.activeTap=e,this.keyWord="",this.$emit("update:activeNode",{}),this.$emit("switch-tap",e)},addCompanyShow:function(e){this.addNodeDetail=e,this.addCompanyModalShow=!0},getStructureData:function(){this.$emit("fresh-org",this.activeNode)},addScene:function(e){this.addNodeDetail=e,this.addSceneModalShow=!0},addCashier:function(e){this.addNodeDetail=e,this.addCashierModalShow=!0},addDepartment:function(e){var t=this;g.a.post("addOrgInfo",{orgName:e.nodeName,nodeType:"department",parentManageId:this.currentNode.id,parentEconomicId:this.currentNode.id}).then(function(e){e.success?(t.$Message.success("新增成功"),t.getStructureData()):t.$Message.error("新增失败")})},delNode:function(e){var t=this;g.a.post("deleteOrg",{orgId:e.id}).then(function(e){e.success?(t.$Message.success("删除成功"),t.$emit("switch-tap",t.activeTap)):"S007"===e.code?t.$refs.delModalTip.show({title:"提示"}):t.$Message.error("删除失败")})},filterNode:function(e,t){return!e||t&&t.orgName&&-1!==t.orgName.indexOf(e)},clearDetail:function(e){!1===e&&(this.currentNode={})}},computed:{companyData:function(){return 0<s()(this.treeData).length?[this.treeData]:[]},rootId:function(){return this.treeData&&0<this.treeData.length?this.treeData[0].id:""},defaultExpandedKeys:function(){return this.activeNode?[this.activeNode.id]:[]}},watch:{keyWord:function(e,t){this.$refs.tree.filter(e)}}},L={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"structure-tree"},[a("ul",{staticClass:"head"},[a("li",{staticClass:"tree-title",class:{active:"manage"===t.activeTap},on:{click:function(e){t.switchTap("manage")}}},[a("span",{staticClass:"iconfont icon-finance"}),t._v("\n            经营管理\n        ")]),t._v(" "),a("li",{staticClass:"tree-title",class:{active:"economic"===t.activeTap},on:{click:function(e){t.switchTap("economic")}}},[a("span",{staticClass:"iconfont icon-manage"}),t._v("\n            财务管理\n        ")])]),t._v(" "),a("div",{staticClass:"search-input"},[a("Input",{staticStyle:{width:"360px"},attrs:{placeholder:"请输入查找内容",icon:"ios-search"},model:{value:t.keyWord,callback:function(e){t.keyWord="string"==typeof e?e.trim():e},expression:"keyWord"}})],1),t._v(" "),a("div",{staticClass:"tree-plugin"},[0<t.companyData.length?a("el-tree",{ref:"tree",attrs:{data:t.companyData,"node-key":"id",props:t.defaultProps,"default-expanded-keys":t.defaultExpandedKeys,"expand-on-click-node":!1,"filter-node-method":t.filterNode,"render-content":t.renderContent}}):a("no-data")],1),t._v(" "),a("del-modal",{ref:"delModal"},[a("span",{staticClass:"red-bale"},[t._v("本操作将同步删除本节点的全部下级节点，并不可撤销，")]),t._v(" "),a("span",[t._v("是否继续删除？")])]),t._v(" "),a("edit-modal",{ref:"delModalTip"},[a("div",{staticStyle:{padding:"0 20px"}},[t._v(t._s(t.$t("S007")))])]),t._v(" "),a("add-modal",{attrs:{"node-detail":t.currentNode},on:{"add-com-modal-show":t.addCompanyShow,"add-scene-modal-show":t.addScene,"add-cashier-modal-show":t.addCashier,"add-department":t.addDepartment},model:{value:t.addModalShow,callback:function(e){t.addModalShow=e},expression:"addModalShow"}}),t._v(" "),a("add-company",{attrs:{"root-id":t.rootId,"chosed-node-detail":t.currentNode,"added-node-detail":t.addNodeDetail},on:{"fresh-structure-data":t.getStructureData,input:t.clearDetail},model:{value:t.addCompanyModalShow,callback:function(e){t.addCompanyModalShow=e},expression:"addCompanyModalShow"}}),t._v(" "),a("add-scene",{attrs:{"root-id":t.rootId,"chosed-node-detail":t.currentNode,"added-node-detail":t.addNodeDetail},on:{"fresh-structure-data":t.getStructureData,input:t.clearDetail},model:{value:t.addSceneModalShow,callback:function(e){t.addSceneModalShow=e},expression:"addSceneModalShow"}}),t._v(" "),a("add-cashier",{attrs:{"chosed-node-detail":t.currentNode,"added-node-detail":t.addNodeDetail},on:{"fresh-structure-data":t.getStructureData,input:t.clearDetail},model:{value:t.addCashierModalShow,callback:function(e){t.addCashierModalShow=e},expression:"addCashierModalShow"}})],1)},staticRenderFns:[]};var M=a("VU/8")(P,L,!1,function(e){a("/NiU")},"data-v-3e0a4156",null).exports,U={props:{"table-data":{type:Array,default:function(){return[]}},"column-data":{type:[Object,Array],default:function(){return{}}},title:{type:String,default:""},"column-check":{type:Boolean,default:!1},"is-pack-up":{type:Boolean,default:!1},"show-page":{type:Boolean,default:!1},total:{type:Number,default:0},"show-table-bar":{type:Boolean,default:!0}},data:function(){return{isPackUpLoad:this.isPackUp,pageSizeConfig:p.e.pageSizeConfig,pageSize:p.e.pageDefaultSize,pageNo:1}},methods:{classDetailLink:function(e){this.$emit("row-click",e)},handleSelectionChange:function(e){this.$emit("selection-change",e)},sizeChange:function(e){this.pageSize=e,this.$emit("get-new-data",{pageSize:this.pageSize,pageNo:this.pageNo})},pageNoChange:function(e){this.$emit("get-new-data",{pageSize:this.pageSize,pageNo:this.pageNo})},filterHandler:function(e){this.$emit("filter-method",e)},getFilters:function(a){var i=this,s=[];if(a.filters){for(var e=function(t,e){s.some(function(e){return e.value===i.tableData[t][a.field]})||s.push({text:i.tableData[t][a.field],value:i.tableData[t][a.field]})},t=0,n=this.tableData.length;t<n;t++)e(t);return s}return[]}},created:function(){this.$emit("get-new-data",{pageSize:this.pageSize,pageNo:this.pageNo})}},E={render:function(){var a=this,e=a.$createElement,i=a._self._c||e;return i("div",{staticClass:"table-com"},[a.title?i("div",{staticClass:"table-name"},[i("span",{staticClass:"label"},[a._v(a._s(a.title))]),a._v(" "),i("span",{staticClass:"back-up",on:{click:function(e){a.isPackUpLoad=!a.isPackUpLoad}}},[a._v("\n        "+a._s(a.$t(a.isPackUpLoad?"backUp":"upLoad"))+"\n            "),i("span",{staticClass:"iconfont icon-pull-down",class:{"icon-reverse":a.isPackUpLoad}})])]):a._e(),a._v(" "),i("transition",{attrs:{name:"fade"}},[a.isPackUpLoad?i("div",[a.showTableBar?i("div",{staticClass:"table-bar"}):a._e(),a._v(" "),a._t("table-title"),a._v(" "),i("el-table",{staticStyle:{width:"100%"},attrs:{data:a.tableData},on:{"row-click":a.classDetailLink,"filter-change":a.filterHandler,"selection-change":a.handleSelectionChange}},[a.columnCheck?i("el-table-column",{attrs:{type:"selection",width:"55"}}):a._e(),a._v(" "),a._l(a.columnData,function(t,e){return[a._t("column"+e,[t.ableClick?i("el-table-column",{key:e,attrs:{label:t.title,prop:t.field,width:t.width,"min-width":t.minWidth},scopedSlots:a._u([{key:"default",fn:function(e){return[i("span",{staticClass:"borderNone iconfont",class:{"icon-male":"m"===e.row.sex,"icon-female":"f"===e.row.sex}}),a._v(" "),i("span",{directives:[{name:"w-title",rawName:"v-w-title",value:e.row[t.field],expression:"scoped.row[item.field]"}],staticClass:"detail-hover"},[a._v(a._s(a._f("contentFilter")(e.row[t.field])))])]}}])}):t.fixed?i("el-table-column",{key:e,attrs:{label:t.title,prop:t.field,width:t.width,"min-width":t.minWidth},scopedSlots:a._u([{key:"default",fn:function(e){return a._l(t.operateList,function(e){return i("span",{staticClass:"operate-info",on:{click:e.click}},[a._v(a._s(e.name))])})}}])}):i("el-table-column",{key:e,attrs:{label:t.title,prop:t.field,filters:a.getFilters(t),width:t.width,"filter-multiple":!1,"min-width":t.minWidth},scopedSlots:a._u([{key:"default",fn:function(e){return["time"===t.type?i("span",{directives:[{name:"w-title",rawName:"v-w-title",value:e.row[t.field],expression:"scoped.row[item.field]"}]},[a._v("\n                                    "+a._s(a._f("contentFilter")(a._f("timeFormat")(e.row[t.field],"yyyy-MM-dd HH:mm")))+"\n                                ")]):i("span",{directives:[{name:"w-title",rawName:"v-w-title",value:e.row[t.field],expression:"scoped.row[item.field]"}]},[a._v(a._s(a._f("contentFilter")(e.row[t.field])))])]}}])})],{width:t.width,minWidth:t.minWidth,index:e,field:t.field,title:t.title})]}),a._v(" "),a._t("default")],2),a._v(" "),a.showPage&&0<a.total?i("div",{staticClass:"page-area"},[i("el-pagination",{attrs:{"current-page":a.pageNo,"page-sizes":a.pageSizeConfig,"page-size":a.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:a.total},on:{"update:currentPage":function(e){a.pageNo=e},"size-change":a.sizeChange,"current-change":a.pageNoChange}})],1):a._e()],2):a._e()])],1)},staticRenderFns:[]};var O=a("VU/8")(U,E,!1,function(e){a("Aju2")},"data-v-10c08f5d",null).exports,V=a("DB50"),q=[{title:"部门",minWidth:120,field:"deptName",filters:!0},{title:"姓名",minWidth:150,field:"nickName",filters:!0},{title:"登录账号",minWidth:130,field:"loginName"}],z=[{title:"员工编号",minWidth:220,field:"id"},{title:"姓名",minWidth:150,field:"nickName"},{title:"电话",minWidth:150,field:"phone"},{title:"登录账号",minWidth:130,field:"loginName"}],G={props:{type:{type:String,default:"noDepartment"},"search-params":{typee:Object,default:function(){return{}}},isDefaultPackUp:{type:Boolean,default:!1},"is-department":{type:Boolean,default:!1}},components:{tableCom:V.a},data:function(){return{tableData:[],employeeColumn:"department"===this.type?z:q,totalCount:0,pageNo:1,pageSize:10,employeeNumber:"",isPackUp:!1}},methods:{getEmployees:function(){var t=this,e={};e=this.isDepartment?{deptId:this.searchParams.id,pageNo:this.pageNo,pageSize:this.pageSize}:{orgId:this.searchParams.id,pageNo:this.pageNo,pageSize:this.pageSize},g.a.post("getEmployeeList",e).then(function(e){e.success?(t.tableData=e.data?e.data.data:[],t.totalCount=t.employeeNumber=e.data.totalRow):(t.tableData=[],t.employeeNumber="",t.totalCount=0)})}},computed:{tableShow:function(){return this.searchParams&&this.searchParams.id}},watch:{isDefaultPackUp:{handler:function(e){this.isPackUp=!0===e},immediate:!0}}},A={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"employee-table"},[a("div",{staticClass:"pick-up-title"},[a("span",{staticClass:"label"},[t._v("员工账号")]),t._v(" "),a("span",{staticClass:"back-up",on:{click:function(e){t.isPackUp=!t.isPackUp}}},[t._v("\n        "+t._s(t.$t(t.isPackUp?"backUp":"upLoad"))+"\n            "),a("span",{staticClass:"iconfont icon-arrow-down",class:{"icon-reverse":t.isPackUp}})])]),t._v(" "),a("transition",{attrs:{name:"fade"}},[t.isPackUp?a("div",{staticClass:"table-wrap"},[a("div",{staticClass:"employee-account"},[t._v("\n                员工账号数："+t._s(t._f("contentFilter")(t.employeeNumber))+"\n            ")]),t._v(" "),t.tableShow?a("table-com",{attrs:{"column-data":t.employeeColumn,"table-data":t.tableData,border:!0,"page-no-d":t.pageNo,"show-pagination":!0,"page-size-d":t.pageSize,"total-count":t.totalCount,"auto-height":!0,"table-com-min-height":280},on:{"update:pageNoD":function(e){t.pageNo=e},"update:pageSizeD":function(e){t.pageSize=e},"query-data":t.getEmployees}}):t._e()],1):t._e()])],1)},staticRenderFns:[]};var B=a("VU/8")(G,A,!1,function(e){a("iYsa")},"data-v-473195a0",null).exports,W=[{title:"序号",width:90,field:"index"},{title:"服务名称",minWidth:150,field:"serviceName"},{title:"服务开始日期",minWidth:190,field:"startTime"},{title:"服务结束日期",minWidth:190,field:"startTime"},{title:"服务状态",minWidth:100,field:"runStatus"}],j={props:{"scene-detail":{type:Object,default:function(){return{}}},"opened-services":{type:Array,default:function(){return[]}}},components:{tableCom:V.a},data:function(){return{modalShow:!1,confirmCallback:null,cancelCallback:null,columns:W,totalCount:0,selectedService:[],pageSize:10,pageNo:1,tableData:[]}},methods:{visibleChange:function(e){!1===e&&this.handleSelectionChange([])},cancel:function(){this.modalShow=!1,this.cancelCallback&&this.cancelCallback()},confirm:function(){if(this.selectedService.length<1)this.$Message.warning("请选择服务");else{var e=[];if(0===this.openedServices.length)e=this.selectedService;else for(var t=0,a=this.openedServices.length;t<a;t++)for(this.selectedService.length;t<a;t++)this.openedServices[t].serviceId!==this.selectedService[0].serviceId&&e.push(this.selectedService[0]);this.openScenicServices(e)}},show:function(e){var t=e.confirmCallback,a=void 0===t?null:t,i=e.cancelCallback;this.modalShow=!0,a&&"function"==typeof a&&(this.confirmCallback=a),i&&"function"==typeof i&&(this.cancelCallback=i)},handleSelectionChange:function(e){this.selectedService=e},queryList:function(){var t=this;g.a.post("getOrgServiceList",{orgId:this.sceneDetail.id,pageNo:1,pageSize:9999}).then(function(e){e.success?(t.tableData=e.data&&e.data.rootServiceList?e.data.rootServiceList.data:[],t.$nextTick(function(){})):t.tableData=[]})},openScenicServices:function(e){var t=this;g.a.post("addOrgServiceList",e.map(function(e){return{orgId:t.sceneDetail.id,startTime:e.startTime,endTime:e.endTime,serviceId:e.serviceId,serviceName:e.serviceName}}),{headers:{"Content-Type":"application/json;charset-UTF-8"}}).then(function(e){e.success?(t.$Message.success("开通成功"),t.$emit("fresh-service")):t.$Message.error("开通失败")}).finally(function(){t.modalShow=!1})},setDefaultChosed:function(e){for(var t=0,a=this.openedServices.length;t<a;t++)for(var i=0,s=e.length;i<s;i++)e[i].serviceId===this.openedServices[t].serviceId&&this.$refs.multipleTable.toggleRowSelection(e[t])},test:function(e,t){if(this.$refs.multipleTable.toggleRowSelection(),!1===t)for(var a=0,i=this.selectedService.length;a<i;a++)this.selectedService[a]===e&&this.$refs.multipleTable.toggleRowSelection(this.selectedService[a]);else for(var s=0,n=this.tableData.length;s<n;s++)this.tableData[s]===e&&this.$refs.multipleTable.toggleRowSelection(this.tableData[s])}},computed:{tableShow:function(){return this.sceneDetail&&!!this.sceneDetail.id&&this.modalShow}}},R={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Modal",{staticClass:"add-service",attrs:{title:"Title","mask-closable":!1,"class-name":"vertical-center-modal"},on:{"on-visible-change":t.visibleChange},model:{value:t.modalShow,callback:function(e){t.modalShow=e},expression:"modalShow"}},[a("div",{staticClass:"target-class",attrs:{slot:"header"},slot:"header"},[a("span",{staticClass:"title"},[t._v("添加服务")])]),t._v(" "),a("div",{staticClass:"service-body"},[a("div",{staticClass:"label-info"},[a("span",{staticClass:"key"},[t._v("上级公司：")]),t._v(" "),a("span",{staticClass:"val"},[t._v("\n                "+t._s(t._f("contentFilter")(t.sceneDetail.parentManager))+"\n                 "),a("Tooltip",{attrs:{placement:"top"}},[a("div",{staticClass:"tips-content",attrs:{slot:"content"},slot:"content"},[t._v("\n                        "+t._s(t.$t("请先为上级公司开通服务后，景区才能添加相应服务。"))+"\n                    ")]),t._v(" "),a("span",{staticClass:"iconfont icon-note"})])],1)]),t._v(" "),a("div",{staticClass:"label-info",staticStyle:{"margin-bottom":"10px"}},[a("span",{staticClass:"val"},[t._v("上级公司已开通服务：")])]),t._v(" "),t.tableShow?a("table-com",{ref:"multipleTable",attrs:{"column-data":t.columns,"table-data":t.tableData,height:250},on:{"query-data":t.queryList,"selection-change":t.handleSelectionChange},scopedSlots:t._u([{key:"column0",fn:function(e){return a("el-table-column",{attrs:{type:"selection",fixed:"left",disabled:!0,label:e.title,width:e.width,"min-width":e.minWidth}})}},{key:"column4",fn:function(e){return a("el-table-column",{attrs:{label:e.title,"show-overflow-tooltip":"",width:e.width,"min-width":e.minWidth},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                    "+t._s("normal"===e.row.runStatus?t.$t("opened"):"invalid"===e.row.runStatus?t.$t("paused"):t.$t("expired"))+"\n                ")]}}])})}}])}):t._e()],1),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{staticClass:"ivu-btn-90px",on:{click:t.cancel}},[t._v("\n            "+t._s(t.$t("cancel"))+"\n        ")]),t._v(" "),a("Button",{staticClass:"ivu-btn-90px",attrs:{type:"primary"},on:{click:t.confirm}},[t._v("\n            "+t._s(t.$t("save"))+"\n        ")])],1)])},staticRenderFns:[]};var H=a("VU/8")(j,R,!1,function(e){a("UH8q")},"data-v-34f6dea5",null).exports,J={props:{type:{type:String,default:"company"},"search-params":{typee:Object,default:function(){return{}}},"scene-detail":{typee:Object,default:function(){return{}}},isDefaultPackUp:{type:Boolean,default:!1}},components:{tableCom:V.a,delModal:c.a,addService:H},data:function(){return{selectedService:[],openedServiceHead:W,tableData:[],totalCount:100,isPackUp:!0,pageNo:1,pageSize:10}},methods:{handleSelectionChange:function(e){this.selectedService=e},delService:function(e){var t=this;this.$refs.delModal.show({title:"删除服务",confirmCallback:function(){t.comfirmDeletService(e.map(function(e){return e.id}))}})},orgAddService:function(){this.$refs.addService.show({confirmCallback:function(e){console.log(e)}})},queryList:function(){var t=this;g.a.post("getOrgServiceList",{orgId:this.searchParams.id,page:this.pageNo,pageSize:this.pageSize}).then(function(e){e.success?(t.tableData=e.data&&e.data.serviceList?e.data.serviceList.data:[],t.totalCount=Number(e.data.serviceList.totalRow)):(t.tableData=[],t.totalCount=0)})},comfirmDeletService:function(e){var t=this;g.a.post("deleteOrgServiceList",e.map(function(e){return{id:e}}),{headers:{"Content-Type":"application/json;charset-UTF-8"}}).then(function(e){e.success?(t.$Message.success("删除成功"),t.queryList()):t.$Message.error("删除失败")})}},computed:{canDelService:function(){return 0<this.selectedService.length},tableShow:function(){return this.searchParams&&this.searchParams.id}},watch:{isDefaultPackUp:{handler:function(e){this.isPackUp=!0===e},immediate:!0}}},K={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"opened-service"},[a("div",{staticClass:"pick-up-title"},[a("span",{staticClass:"label"},[t._v(t._s(t.$t("openedService")))]),t._v(" "),a("span",{staticClass:"back-up",on:{click:function(e){t.isPackUp=!t.isPackUp}}},[t._v("\n                "+t._s(t.$t(t.isPackUp?"backUp":"upLoad"))+"\n            "),a("span",{staticClass:"iconfont icon-arrow-down",class:{"icon-reverse":t.isPackUp}})])]),t._v(" "),a("transition",{attrs:{name:"fade"}},[t.isPackUp?a("div",{staticClass:"table-wrap"},["scene"===t.type?a("div",{staticClass:"service-operation"},[a("Button",{attrs:{type:"primary",disabled:!t.canDelService},on:{click:function(e){t.delService(t.selectedService)}}},[t._v("删除服务")]),t._v(" "),a("Button",{attrs:{type:"primary"},on:{click:function(e){t.orgAddService(t.selectedService)}}},[t._v("添加服务")])],1):t._e(),t._v(" "),t.tableShow&&"scene"===t.type?a("table-com",{attrs:{"column-data":t.openedServiceHead,"table-data":t.tableData,border:!0,"page-no-d":t.pageNo,"show-pagination":!0,"page-size-d":t.pageSize,"total-count":t.totalCount,"auto-height":!0,"table-com-min-height":280},on:{"update:pageNoD":function(e){t.pageNo=e},"update:pageSizeD":function(e){t.pageSize=e},"query-data":t.queryList,"selection-change":t.handleSelectionChange},scopedSlots:t._u([{key:"column0",fn:function(e){return a("el-table-column",{key:t.type,attrs:{label:e.title,fixed:"left",type:"selection",width:e.width,"min-width":e.minWidth}})}},{key:"column4",fn:function(e){return a("el-table-column",{attrs:{label:e.title,"show-overflow-tooltip":"",width:e.width,"min-width":e.minWidth},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                        "+t._s("normal"===e.row.runStatus?t.$t("opened"):"invalid"===e.row.runStatus?t.$t("paused"):t.$t("expired"))+"\n                    ")]}}])})}}])}):t._e(),t._v(" "),t.tableShow&&"company"===t.type?a("table-com",{attrs:{"column-data":t.openedServiceHead,"table-data":t.tableData,border:!0,"page-no-d":t.pageNo,"show-pagination":!0,"page-size-d":t.pageSize,"total-count":t.totalCount,"auto-height":!0,"table-com-min-height":280},on:{"update:pageNoD":function(e){t.pageNo=e},"update:pageSizeD":function(e){t.pageSize=e},"query-data":t.queryList,"selection-change":t.handleSelectionChange},scopedSlots:t._u([{key:"column0",fn:function(e){return a("el-table-column",{key:t.type,attrs:{label:e.title,"show-overflow-tooltip":"",width:e.width,"min-width":e.minWidth},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                        "+t._s((t.pageNo-1)*t.pageSize+e.$index+1)+"\n                    ")]}}])})}},{key:"column4",fn:function(e){return a("el-table-column",{attrs:{label:e.title,"show-overflow-tooltip":"",width:e.width,"min-width":e.minWidth},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                        "+t._s("normal"===e.row.runStatus?t.$t("opened"):"invalid"===e.row.runStatus?t.$t("paused"):t.$t("expired"))+"\n                    ")]}}])})}}])}):t._e()],1):t._e()]),t._v(" "),a("del-modal",{ref:"delModal"},[a("div",{staticClass:"del-tips"},[a("Icon",{attrs:{type:"help-circled"}}),t._v(" "),a("span",{staticClass:"red-bale"},[t._v("删除服务后，本景区在该服务板块下的所有数据也将被同步删除，")]),t._v(" "),a("span",[t._v("请及时保存。")])],1)]),t._v(" "),a("add-service",{ref:"addService",attrs:{"opened-services":t.tableData,"scene-detail":t.sceneDetail},on:{"fresh-service":t.queryList}})],1)},staticRenderFns:[]};var Y=a("VU/8")(J,K,!1,function(e){a("XnEw")},"data-v-ca66d768",null).exports,Z=[{title:"公司ID",minWidth:220,field:"id"},{title:"公司名称",minWidth:220,field:"orgName"},{title:"联系人",minWidth:100,field:"linkName"},{title:"联系电话",minWidth:150,field:"telephone"},{title:"管理员账号",minWidth:130,field:"manager"},{title:"企业编码",minWidth:210,field:"nodeCode"}],X={props:{"search-params":{type:Object,default:function(){return{}}},activeTap:{type:String,default:""}},components:{tableCom:V.a},data:function(){return{companies:Z,tableData:[],totalCount:0,isPackUp:!0,pageNo:1,pageSize:10}},methods:{queryList:function(){var t=this;g.a.post("getSubNodePage",{orgId:this.searchParams.id,nodeType:"company",page:this.pageNo,pageSize:this.pageSize,manageType:this.activeTap}).then(function(e){e.success?(t.tableData=e.data?e.data.data:[],t.totalCount=e.data.totalRow):(t.tableData=[],t.totalCount=0)})}},computed:{tableShow:function(){return this.searchParams&&!!this.searchParams.id}}},Q={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"sub-company"},[a("div",{staticClass:"pick-up-title"},[a("span",{staticClass:"label"},[t._v("下属公司")]),t._v(" "),a("span",{staticClass:"back-up",on:{click:function(e){t.isPackUp=!t.isPackUp}}},[t._v("\n        "+t._s(t.$t(t.isPackUp?"backUp":"upLoad"))+"\n            "),a("span",{staticClass:"iconfont icon-arrow-down",class:{"icon-reverse":t.isPackUp}})])]),t._v(" "),a("transition",{attrs:{name:"fade"}},[t.isPackUp?a("div",{staticClass:"table-wrap"},[t.tableShow?a("table-com",{attrs:{"column-data":t.companies,"table-data":t.tableData,border:!0,"page-no-d":t.pageNo,"show-pagination":!0,"page-size-d":t.pageSize,"total-count":t.totalCount,"auto-height":!0,"table-com-min-height":280},on:{"update:pageNoD":function(e){t.pageNo=e},"update:pageSizeD":function(e){t.pageSize=e},"query-data":t.queryList}}):t._e()],1):t._e()])],1)},staticRenderFns:[]};var ee=a("VU/8")(X,Q,!1,function(e){a("dzx0")},"data-v-2a9f48fe",null).exports,te=[{title:"公司编码",minWidth:210,field:"id"},{title:"景区名称",minWidth:150,field:"orgName"},{title:"管理账号",minWidth:130,field:"manager"},{title:"联系电话",minWidth:130,field:"telephone"}],ae={components:{tableCom:V.a},props:{"search-params":{type:Object,default:function(){return{}}},activeTap:{type:String,default:""}},data:function(){return{region:te,tableData:[],totalCount:0,isPackUp:!0,pageNo:1,pageSize:10}},methods:{queryList:function(){var t=this;g.a.post("getSubNodePage",{orgId:this.searchParams.id,page:this.pageNo,pageSize:this.pageSize,manageType:this.activeTap,nodeType:"scenic"}).then(function(e){e.success?(t.tableData=e.data?e.data.data:[],t.totalCount=e.data.totalRow):(t.tableData=[],t.totalCount=0)}).catch(function(e){console.log(e)})}},computed:{tableShow:function(){return this.searchParams&&this.searchParams.id}}},ie={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"sub-scene"},[a("div",{staticClass:"pick-up-title"},[a("span",{staticClass:"label"},[t._v("下属景区")]),t._v(" "),a("span",{staticClass:"back-up",on:{click:function(e){t.isPackUp=!t.isPackUp}}},[t._v("\n                "+t._s(t.$t(t.isPackUp?"backUp":"upLoad"))+"\n            "),a("span",{staticClass:"iconfont icon-arrow-down",class:{"icon-reverse":t.isPackUp}})])]),t._v(" "),a("transition",{attrs:{name:"fade"}},[t.isPackUp?a("div",{staticClass:"table-wrap"},[t.tableShow?a("table-com",{attrs:{"column-data":t.region,"table-data":t.tableData,border:!0,"page-no-d":t.pageNo,"show-pagination":!0,"page-size-d":t.pageSize,"total-count":t.totalCount,"auto-height":!0,"table-com-min-height":280},on:{"update:pageNoD":function(e){t.pageNo=e},"update:pageSizeD":function(e){t.pageSize=e},"query-data":t.queryList}}):t._e()],1):t._e()])],1)},staticRenderFns:[]};var se=a("VU/8")(ae,ie,!1,function(e){a("L5Uz")},"data-v-3d0ea9bd",null).exports,ne=[{title:"部门ID",minWidth:210,field:"id"},{title:"部门名称",minWidth:150,field:"orgName"},{title:"是否启用",minWidth:130,field:"status"},{title:"部门人数",minWidth:130,field:"empNum"}],oe={props:{"search-params":{type:Object,default:function(){return{}}},activeTap:{type:String,default:""}},components:{tableCom:V.a},data:function(){return{partMentHead:ne,tableData:[],totalCount:0,pageNo:1,pageSize:10,isPackUp:!1}},methods:{queryList:function(){var t=this;g.a.post("getSubNodePage",{orgId:this.searchParams.id,nodeType:"department",page:this.pageNo,pageSize:this.pageSize,manageType:this.activeTap}).then(function(e){e.success?(t.tableData=e.data?e.data.data:[],t.totalCount=e.data.totalRow):(t.tableData=[],t.totalCount=0)})}},computed:{tableShow:function(){return this.searchParams&&this.searchParams.id}}},re={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"sub-department"},[a("div",{staticClass:"pick-up-title"},[a("span",{staticClass:"label"},[t._v(t._s(t.$t("subDepartment")))]),t._v(" "),a("span",{staticClass:"back-up",on:{click:function(e){t.isPackUp=!t.isPackUp}}},[t._v("\n                "+t._s(t.$t(t.isPackUp?"backUp":"upLoad"))+"\n            "),a("span",{staticClass:"iconfont icon-arrow-down",class:{"icon-reverse":t.isPackUp}})])]),t._v(" "),a("transition",{attrs:{name:"fade"}},[t.isPackUp?a("div",{staticClass:"table-wrap"},[t.tableShow?a("table-com",{attrs:{"column-data":t.partMentHead,"table-data":t.tableData,border:!0,"page-no-d":t.pageNo,"show-pagination":!0,"page-size-d":t.pageSize,"total-count":t.totalCount,"auto-height":!0,"table-com-min-height":280},on:{"update:pageNoD":function(e){t.pageNo=e},"update:pageSizeD":function(e){t.pageSize=e},"query-data":t.queryList},scopedSlots:t._u([{key:"column2",fn:function(e){return a("el-table-column",{attrs:{label:e.title,"show-overflow-tooltip":"",width:e.width,"min-width":e.minWidth},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                        "+t._s("close"===e.row.status?t.$t("hasNotStart"):t.$t("hasStart"))+"\n                    ")]}}])})}}])}):t._e()],1):t._e()])],1)},staticRenderFns:[]};var le=a("VU/8")(oe,re,!1,function(e){a("oH9T")},"data-v-3f00b22e",null).exports,ce=a("gs2Y"),de=a.n(ce),pe={props:{activeNode:{type:Object,default:function(){return{}}},activeTap:{type:String,default:""}},components:{tableCom:O,employeeTable:B,openedService:Y,subCompany:ee,subScene:se,subDepartment:le,cityPlugin:_,editModal:d.a},data:function(){var i=this;return{formDataCopy:{},type:"watch",smsSuppilerList:[],superiorList:[],fianceSuperiorList:[],companyDetail:{},ruleValidate:{orgName:[{max:100,message:this.$t("errorMaxLength",{field:this.$t("companyBgName"),length:100}),trigger:"blur"},{required:!0,message:this.$t("inputField",{field:this.$t("companyBgName")}),trigger:"blur"}],checkinCode:[{min:2,max:8,message:this.$t("rangeBitError",{field:this.$t("enterpriseCode"),length:8,min:1,max:10}),trigger:"blur"}],smsProvider:[{required:!0,message:this.$t("selectField",{msg:this.$t("smsProvider")}),trigger:"blur"}],email:[{required:!0,message:this.$t("inputField",{field:this.$t("email")}),trigger:"blur"},{validator:function(e,t,a){t?h.validator.isEmail(t)?a():a(i.$t("errorFormat",{field:i.$t("email")})):a(i.$t("inputField",{field:i.$t("email")}))},trigger:"blur"}],linkName:[{required:!0,message:this.$t("inputField",{field:this.$t("person")}),trigger:"blur"},{max:10,message:this.$t("errorMaxLength",{field:this.$t("person"),length:10}),trigger:"blur"}],address:[{max:100,message:this.$t("errorMaxLength",{field:this.$t("address"),length:100}),trigger:"blur"}],telephone:[{max:20,message:this.$t("errorMaxLength",{field:this.$t("phone"),length:20}),trigger:"blur"},{validator:function(e,t,a){t?h.validator.isTelephone(t)?a():a(i.$t("formalError",{field:i.$t("phone")})):a()},trigger:"blur"}],tex:[{max:20,message:this.$t("errorMaxLength",{field:this.$t("fax"),length:20}),trigger:"blur"}],parentManageId:[{required:!0,message:this.$t("selectField",{msg:this.$t("superior")}),trigger:"blur"}],parentEconomicId:[{required:!0,message:this.$t("selectField",{msg:this.$t("fianceSuperior")}),trigger:"blur"}]}}},methods:{cancel:function(){this.$refs.formValidate.resetFields(),this.type="watch"},saveEdit:function(){var t=this;this.$refs.formValidate.validate(function(e){e&&(t.type="watch",g.a.post("modifyOrgInfo",{id:t.formDataCopy.id,status:t.formDataCopy.isStart?"open":"close",orgName:t.formDataCopy.orgName,checkinCode:t.formDataCopy.checkinCode,smsProvider:t.formDataCopy.smsProvider,email:t.formDataCopy.email,province:t.formDataCopy.provinceCode,city:t.formDataCopy.cityCode,district:t.formDataCopy.districtCode,linkName:t.formDataCopy.linkName,address:t.formDataCopy.address,telephone:t.formDataCopy.telephone,tex:t.formDataCopy.tex,parentManageId:t.formDataCopy.parentManageId,parentEconomicId:t.formDataCopy.parentEconomicId,managerId:t.formDataCopy.managerId,nodeType:t.formDataCopy.nodeType}).then(function(e){e.success?(t.$Message.success("修改成功"),t.formDataCopy.orgName!==t.companyDetail.orgName?t.freshOrg():t.formDataCopy.parentManageId!==t.companyDetail.parentManageId?t.freshOrg():t.formDataCopy.parentEconomicId!==t.companyDetail.parentEconomicId?t.freshOrg():t.getCompanyDetail()):t.$Message.error("修改失败")}))})},edit:function(){this.formDataCopy=de()({isStart:"open"===this.companyDetail.status},this.companyDetail),this.type="edit"},resetPass:function(){var e=this;this.$refs.editModal.show({title:"重置密码",confirmCallback:function(){e.confimChangePass()}})},confimChangePass:function(){var t=this;g.a.post("resetManagerPassword",{orgId:this.activeNode.id,managerId:this.companyDetail.managerId,email:this.companyDetail.email}).then(function(e){e.success?t.$Message.success("重置管理员"+t.companyDetail.manager+"密码成功"):t.$Message.error(e.message||"重置管理员"+t.companyDetail.manager+"密码失败")}).finally(function(){t.$refs.editModal.hide()})},getCompanyDetail:function(){var t=this;g.a.post("getOrgInfo",{orgId:this.activeNode.id}).then(function(e){e.success?t.companyDetail=e.data?e.data.basicInfo:{}:t.companyDetail={}})},querySmsProviderList:function(){var t=this;g.a.post("getSmsProviderList").then(function(e){e.success?t.smsSuppilerList=e.data?e.data:[]:t.smsSuppilerList=[]}).catch(function(){t.smsSuppilerList=[]})},freshOrg:function(){this.$emit("fresh-org",this.activeNode)},changeCity:function(e){e.province&&0<s()(e.province).length?(this.formDataCopy.provinceCode=e.province.provinceid,this.formDataCopy.province=e.province.province):(this.formDataCopy.provinceCode="000000",this.formDataCopy.province=""),e.city&&0<s()(e.city).length?(this.formDataCopy.cityCode=e.city.cityid,this.formDataCopy.city=e.city.city):(this.formDataCopy.cityCode="000000",this.formDataCopy.city=""),e.area&&0<s()(e.area).length?(this.formDataCopy.districtCode=e.area.areaid,this.formDataCopy.district=e.area.area):(this.formDataCopy.districtCode="000000",this.formDataCopy.district="")},getParentManages:function(){var t=this;g.a.post("getOrgsByManageType",{orgId:this.activeNode.id,manageType:"manage",nodeType:this.activeNode.type}).then(function(e){e.success?t.superiorList=e.data?e.data.filter(function(e){return e.id!==t.activeNode.id}):[]:t.superiorList=[]})},getParentEconomic:function(){var t=this;g.a.post("getOrgsByManageType",{orgId:this.activeNode.id,manageType:"economic",nodeType:this.activeNode.type}).then(function(e){e.success?t.fianceSuperiorList=e.data?e.data.filter(function(e){return e.id!==t.activeNode.id}):[]:t.fianceSuperiorList=[]})}},created:function(){this.querySmsProviderList(),this.getParentManages(),this.getParentEconomic()},computed:{companyPlace:function(){var e="";return this.companyDetail&&this.companyDetail.province&&(e+=this.companyDetail.province),this.companyDetail&&this.companyDetail.city&&(e+=this.companyDetail.city),this.companyDetail&&this.companyDetail.district&&(e+=this.companyDetail.district),e},defaultAddress:function(){return!!(this.companyDetail&&0<s()(this.companyDetail).length)&&{province:{provinceid:this.companyDetail.provinceCode,province:this.companyDetail.province},city:{cityid:this.companyDetail.cityCode,city:this.companyDetail.city},area:{areaid:this.companyDetail.districtCode,area:this.companyDetail.district}}}},watch:{activeNode:{handler:function(e,t){this.getCompanyDetail()},deep:!0,immediate:!0}}},me={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"company-detail"},[a("Form",{ref:"formValidate",class:{"form-edit":"edit"===t.type,"form-watch":"watch"===t.type},attrs:{model:t.formDataCopy,rules:t.ruleValidate,"label-position":"edit"===t.type?"top":"left",inline:""}},[a("div",{staticClass:"com-name",class:{"com-min-width":"edit"===t.type}},["edit"===t.type?[a("i-row",[a("i-col",{staticStyle:{width:"240px"},attrs:{span:"9"}},[a("FormItem",{attrs:{prop:"orgName","label-width":"edit"===t.type?0:150}},[a("Input",{staticStyle:{width:"220px"},model:{value:t.formDataCopy.orgName,callback:function(e){t.$set(t.formDataCopy,"orgName","string"==typeof e?e.trim():e)},expression:"formDataCopy.orgName"}})],1)],1),t._v(" "),1!==t.activeNode.level?a("i-col",{staticStyle:{width:"73px"},attrs:{span:"5"}},[a("FormItem",[a("i-switch",{model:{value:t.formDataCopy.isStart,callback:function(e){t.$set(t.formDataCopy,"isStart",e)},expression:"formDataCopy.isStart"}}),t._v(" "),a("span",{class:{started:t.formDataCopy.isStart,"not-started":!t.formDataCopy.isStart}},[t._v("\n                            "+t._s(t.$t(t.formDataCopy.isStart?"hasStart":"hasNotStart"))+"\n                        ")])],1)],1):t._e()],1)]:t._e(),t._v(" "),"watch"===t.type?["watch"===t.type?a("span",{directives:[{name:"w-title",rawName:"v-w-title",value:t.companyDetail.orgName,expression:"companyDetail.orgName"}],staticClass:"name"},[t._v("\n                "+t._s(t.companyDetail.orgName)+"\n            ")]):t._e(),t._v(" "),a("span",{staticClass:"edit",on:{click:t.edit}},[a("span",{staticClass:"iconfont icon-edit"}),t._v("\n                "+t._s(t.$t("modify"))+"\n            ")]),t._v(" "),t.companyDetail.status?a("span",{class:{started:"open"===t.companyDetail.status,"not-started":"close"===t.companyDetail.status}},[t._v("\n                "+t._s(t.$t("open"===t.companyDetail.status?"hasStart":"hasNotStart"))+"\n            ")]):t._e()]:t._e()],2),t._v(" "),a("div",{class:{"form-area":"edit"===t.type}},[a("i-row",[a("i-col",{attrs:{span:"12"}},["edit"===t.type?a("FormItem",{attrs:{label:"公司ID：","label-width":"edit"===t.type?0:150}},[a("Input",{attrs:{disabled:""},model:{value:t.companyDetail.id,callback:function(e){t.$set(t.companyDetail,"id","string"==typeof e?e.trim():e)},expression:"companyDetail.id"}})],1):a("div",{staticClass:"node-info"},[a("span",{staticClass:"info-key"},[t._v("公司ID：")]),t._v(" "),a("span",{directives:[{name:"w-title",rawName:"v-w-title",value:t.companyDetail.id,expression:"companyDetail.id"}],staticClass:"info-val"},[t._v("\n                        "+t._s(t._f("contentFilter")(t.companyDetail.id))+"\n                    ")])])],1),t._v(" "),a("i-col",{attrs:{span:"12"}},["edit"===t.type?a("FormItem",{attrs:{label:"公司编码：","label-width":"edit"===t.type?0:150}},[a("Input",{attrs:{disabled:""},model:{value:t.companyDetail.nodeCode,callback:function(e){t.$set(t.companyDetail,"nodeCode","string"==typeof e?e.trim():e)},expression:"companyDetail.nodeCode"}})],1):a("div",{staticClass:"node-info"},[a("span",{staticClass:"info-key"},[t._v("公司编码：")]),t._v(" "),a("span",{directives:[{name:"w-title",rawName:"v-w-title",value:t.companyDetail.nodeCode,expression:"companyDetail.nodeCode"}],staticClass:"info-val"},[t._v("\n                        "+t._s(t._f("contentFilter")(t.companyDetail.nodeCode))+"\n                    ")])])],1)],1),t._v(" "),a("i-row",[a("i-col",{attrs:{span:"12"}},["edit"===t.type?a("FormItem",{attrs:{prop:"checkinCode",label:"企业编码(线下核销)：","label-width":"edit"===t.type?0:150}},[a("Input",{model:{value:t.formDataCopy.checkinCode,callback:function(e){t.$set(t.formDataCopy,"checkinCode","string"==typeof e?e.trim():e)},expression:"formDataCopy.checkinCode"}})],1):a("div",{staticClass:"node-info"},[a("span",{staticClass:"info-key"},[t._v("企业编码(线下核销)：")]),t._v(" "),a("span",{directives:[{name:"w-title",rawName:"v-w-title",value:t.companyDetail.checkinCode,expression:"companyDetail.checkinCode"}],staticClass:"info-val"},[t._v("\n                        "+t._s(t._f("contentFilter")(t.companyDetail.checkinCode))+"\n                    ")])])],1),t._v(" "),a("i-col",{attrs:{span:"12"}},["edit"===t.type?a("FormItem",{attrs:{label:"全民分销邀请码：","label-width":"edit"===t.type?0:150}},[a("Input",{attrs:{disabled:""},model:{value:t.companyDetail.saleCode,callback:function(e){t.$set(t.companyDetail,"saleCode","string"==typeof e?e.trim():e)},expression:"companyDetail.saleCode"}})],1):a("div",{staticClass:"node-info"},[a("span",{staticClass:"info-key"},[t._v("全民分销邀请码：")]),t._v(" "),a("span",{directives:[{name:"w-title",rawName:"v-w-title",value:t.companyDetail.saleCode,expression:"companyDetail.saleCode"}],staticClass:"info-val"},[t._v("\n                        "+t._s(t._f("contentFilter")(t.companyDetail.saleCode))+"\n                    ")])])],1)],1),t._v(" "),a("i-row",[a("i-col",{attrs:{span:"12"}},["edit"===t.type?a("FormItem",{attrs:{label:"短信供应商：","label-width":"edit"===t.type?0:150,prop:"smsProvider"}},[a("Select",{model:{value:t.formDataCopy.smsProvider,callback:function(e){t.$set(t.formDataCopy,"smsProvider","string"==typeof e?e.trim():e)},expression:"formDataCopy.smsProvider"}},t._l(t.smsSuppilerList,function(e){return a("Option",{key:e.desc,attrs:{value:e.desc}},[t._v("\n                            "+t._s(e.desc)+"\n                        ")])}))],1):a("div",{staticClass:"node-info"},[a("span",{staticClass:"info-key"},[t._v("短信供应商：")]),t._v(" "),a("span",{directives:[{name:"w-title",rawName:"v-w-title",value:t.companyDetail.smsProvider,expression:"companyDetail.smsProvider"}],staticClass:"info-val"},[t._v("\n                        "+t._s(t._f("contentFilter")(t.companyDetail.smsProvider))+"\n                    ")])])],1),t._v(" "),a("i-col",{attrs:{span:"12"}},["edit"===t.type?a("FormItem",{attrs:{label:"管理账号：","label-width":"edit"===t.type?0:150}},[a("Input",{attrs:{disabled:""},model:{value:t.companyDetail.manager,callback:function(e){t.$set(t.companyDetail,"manager","string"==typeof e?e.trim():e)},expression:"companyDetail.manager"}})],1):a("div",{staticClass:"node-info"},[a("span",{staticClass:"info-key"},[t._v("管理账号：")]),t._v(" "),a("span",{directives:[{name:"w-title",rawName:"v-w-title",value:t.companyDetail.manager,expression:"companyDetail.manager"}],staticClass:"info-val"},[t._v("\n                         "+t._s(t._f("contentFilter")(t.companyDetail.manager))+"\n                        "),t.activeNode&&1!==t.activeNode.level?a("span",{staticClass:"reset-pass",on:{click:t.resetPass}},[t._v("重置密码")]):t._e()])])],1)],1),t._v(" "),a("i-row",[a("i-col",{attrs:{span:"12"}},["edit"===t.type?a("FormItem",{attrs:{prop:"email",label:"电子邮箱：","label-width":"edit"===t.type?0:150}},[a("Input",{model:{value:t.formDataCopy.email,callback:function(e){t.$set(t.formDataCopy,"email","string"==typeof e?e.trim():e)},expression:"formDataCopy.email"}})],1):a("div",{staticClass:"node-info"},[a("span",{staticClass:"info-key"},[t._v("电子邮箱：")]),t._v(" "),a("span",{directives:[{name:"w-title",rawName:"v-w-title",value:t.formDataCopy.email,expression:"formDataCopy.email"}],staticClass:"info-val"},[t._v("\n                         "+t._s(t._f("contentFilter")(t.companyDetail.email))+"\n                    ")])])],1),t._v(" "),a("i-col",{attrs:{span:"12"}},["edit"===t.type?a("FormItem",{attrs:{prop:"linkName",label:"联系人：","label-width":"edit"===t.type?0:150}},[a("Input",{model:{value:t.formDataCopy.linkName,callback:function(e){t.$set(t.formDataCopy,"linkName","string"==typeof e?e.trim():e)},expression:"formDataCopy.linkName"}})],1):a("div",{staticClass:"node-info"},[a("span",{staticClass:"info-key"},[t._v("联系人：")]),t._v(" "),a("span",{directives:[{name:"w-title",rawName:"v-w-title",value:t.formDataCopy.linkName,expression:"formDataCopy.linkName"}],staticClass:"info-val"},[t._v("\n                         "+t._s(t._f("contentFilter")(t.companyDetail.linkName))+"\n                    ")])])],1)],1),t._v(" "),a("i-row",[a("i-col",{attrs:{span:"12"}},[t.defaultAddress&&"edit"===t.type?a("FormItem",{attrs:{label:"所在地：","label-width":"edit"===t.type?0:150}},[a("city-plugin",{attrs:{defaultValue:t.defaultAddress},on:{select:t.changeCity}})],1):a("div",{staticClass:"node-info"},[a("span",{staticClass:"info-key"},[t._v("所在地：")]),t._v(" "),a("span",{directives:[{name:"w-title",rawName:"v-w-title",value:t.companyPlace,expression:"companyPlace"}],staticClass:"info-val"},[t._v("\n                         "+t._s(t._f("contentFilter")(t.companyPlace))+"\n                    ")])])],1),t._v(" "),a("i-col",{attrs:{span:"12"}},["edit"===t.type?a("FormItem",{attrs:{prop:"address",label:"详细地址：","label-width":"edit"===t.type?0:150}},[a("Input",{model:{value:t.formDataCopy.address,callback:function(e){t.$set(t.formDataCopy,"address",e)},expression:"formDataCopy.address"}})],1):a("div",{staticClass:"node-info"},[a("span",{staticClass:"info-key"},[t._v("详细地址：")]),t._v(" "),a("span",{directives:[{name:"w-title",rawName:"v-w-title",value:t.companyDetail.address,expression:"companyDetail.address"}],staticClass:"info-val"},[t._v("\n                         "+t._s(t._f("contentFilter")(t.companyDetail.address))+"\n                    ")])])],1)],1),t._v(" "),a("i-row",[a("i-col",{attrs:{span:"12"}},["edit"===t.type?a("FormItem",{attrs:{prop:"telephone",label:"电话：","label-width":"edit"===t.type?0:150}},[a("Input",{model:{value:t.formDataCopy.telephone,callback:function(e){t.$set(t.formDataCopy,"telephone","string"==typeof e?e.trim():e)},expression:"formDataCopy.telephone"}})],1):a("div",{staticClass:"node-info"},[a("span",{staticClass:"info-key"},[t._v("电话：")]),t._v(" "),a("span",{directives:[{name:"w-title",rawName:"v-w-title",value:t.companyDetail.telephone,expression:"companyDetail.telephone"}],staticClass:"info-val"},[t._v("\n                         "+t._s(t._f("contentFilter")(t.companyDetail.telephone))+"\n                    ")])])],1),t._v(" "),a("i-col",{attrs:{span:"12"}},["edit"===t.type?a("FormItem",{attrs:{prop:"tex",label:"传真：","label-width":"edit"===t.type?0:150}},[a("Input",{model:{value:t.formDataCopy.tex,callback:function(e){t.$set(t.formDataCopy,"tex","string"==typeof e?e.trim():e)},expression:"formDataCopy.tex"}})],1):a("div",{staticClass:"node-info"},[a("span",{staticClass:"info-key"},[t._v("传真：")]),t._v(" "),a("span",{directives:[{name:"w-title",rawName:"v-w-title",value:t.companyDetail.tex,expression:"companyDetail.tex"}],staticClass:"info-val"},[t._v("\n                         "+t._s(t._f("contentFilter")(t.companyDetail.tex))+"\n                    ")])])],1)],1),t._v(" "),a("i-row",[a("i-col",{attrs:{span:"12"}},["edit"===t.type?a("FormItem",{attrs:{prop:t.activeNode&&1!==t.activeNode.level?"parentManageId":"",label:"管理上级：","label-width":"edit"===t.type?0:150}},[a("Select",{attrs:{disabled:t.activeNode&&1===t.activeNode.level},model:{value:t.formDataCopy.parentManageId,callback:function(e){t.$set(t.formDataCopy,"parentManageId","string"==typeof e?e.trim():e)},expression:"formDataCopy.parentManageId"}},t._l(t.superiorList,function(e){return a("Option",{key:e.id,attrs:{value:e.id}},[t._v("\n                            "+t._s(e.orgName)+"\n                        ")])}))],1):a("div",{staticClass:"node-info"},[a("span",{staticClass:"info-key"},[t._v("管理上级：")]),t._v(" "),a("span",{directives:[{name:"w-title",rawName:"v-w-title",value:t.companyDetail.parentManager,expression:"companyDetail.parentManager"}],staticClass:"info-val"},[1!==t.activeNode.level?[t._v("\n                            "+t._s(t._f("contentFilter")(t.companyDetail.parentManager))+"\n                        ")]:[t._v("-")]],2)])],1),t._v(" "),a("i-col",{attrs:{span:"12"}},["edit"===t.type?a("FormItem",{attrs:{prop:t.activeNode&&1!==t.activeNode.level?"parentEconomicId":"",label:"财务上级：","label-width":"edit"===t.type?0:150}},[a("Select",{attrs:{disabled:t.activeNode&&1===t.activeNode.level},model:{value:t.formDataCopy.parentEconomicId,callback:function(e){t.$set(t.formDataCopy,"parentEconomicId","string"==typeof e?e.trim():e)},expression:"formDataCopy.parentEconomicId"}},t._l(t.fianceSuperiorList,function(e){return a("Option",{key:e.id,attrs:{value:e.id}},[t._v("\n                            "+t._s(e.orgName)+"\n                        ")])}))],1):a("div",{staticClass:"node-info"},[a("span",{staticClass:"info-key"},[t._v("财务上级：")]),t._v(" "),a("span",{directives:[{name:"w-title",rawName:"v-w-title",value:t.companyDetail.parentEconomic,expression:"companyDetail.parentEconomic"}],staticClass:"info-val"},[1!==t.activeNode.level?[t._v("\n                            "+t._s(t._f("contentFilter")(t.companyDetail.parentEconomic))+"\n                        ")]:[t._v("-")]],2)])],1)],1),t._v(" "),a("i-row",[a("i-col",{attrs:{span:"12"}},["edit"===t.type?a("FormItem",{attrs:{prop:"orgName",label:"短信余量/累计购买：","label-width":"edit"===t.type?0:150}},[a("Input",{attrs:{value:t.companyDetail.smsCount+"/"+t.companyDetail.totalSmsCount,disabled:""}})],1):a("div",{staticClass:"node-info"},[a("span",{staticClass:"info-key"},[t._v("短信余量/累计购买：")]),t._v(" "),a("span",{staticClass:"info-val"},[t._v("\n                        "+t._s(t._f("contentFilter")(t.companyDetail.smsCount))+" / "+t._s(t._f("contentFilter")(t.companyDetail.totalSmsCount))+"\n                    ")])])],1),t._v(" "),a("i-col",{attrs:{span:"12"}},["edit"===t.type?a("FormItem",{attrs:{prop:"orgName",label:"受理客服：","label-width":"edit"===t.type?0:150}},[a("Input",{attrs:{disabled:""},model:{value:t.companyDetail.customerService,callback:function(e){t.$set(t.companyDetail,"customerService","string"==typeof e?e.trim():e)},expression:"companyDetail.customerService"}})],1):a("div",{staticClass:"node-info"},[a("span",{staticClass:"info-key"},[t._v("受理客服：")]),t._v(" "),a("span",{directives:[{name:"w-title",rawName:"v-w-title",value:t.companyDetail.customerService,expression:"companyDetail.customerService"}],staticClass:"info-val"},[t._v("\n                         "+t._s(t._f("contentFilter")(t.companyDetail.customerService))+"\n                    ")])])],1)],1),t._v(" "),"edit"===t.type?a("i-row",{staticStyle:{"margin-top":"10px"}},[a("i-col",{staticStyle:{"text-align":"center"},attrs:{span:"24"}},[a("Button",{staticClass:"ivu-btn-90px",staticStyle:{"margin-right":"5px"},attrs:{type:"primary"},on:{click:t.saveEdit}},[t._v(t._s(t.$t("save")))]),t._v(" "),a("Button",{staticClass:"ivu-btn-90px",attrs:{type:"ghost"},on:{click:t.cancel}},[t._v(t._s(t.$t("cancel")))])],1)],1):t._e()],1)]),t._v(" "),a("opened-service",{attrs:{isDefaultPackUp:!0,"search-params":{id:t.activeNode.id}}}),t._v(" "),a("sub-company",{attrs:{activeTap:t.activeTap,"search-params":{id:t.activeNode.id}}}),t._v(" "),a("sub-scene",{attrs:{activeTap:t.activeTap,"search-params":{id:t.activeNode.id}}}),t._v(" "),a("sub-department",{attrs:{activeTap:t.activeTap,"search-params":{id:t.activeNode.id}},on:{"org-change":t.freshOrg}}),t._v(" "),a("employee-table",{attrs:{isDefaultPackUp:!1,"search-params":{id:t.activeNode.id}}}),t._v(" "),a("edit-modal",{ref:"editModal"},[a("div",{staticStyle:{padding:"0 20px","word-break":"break-all",width:"100%"}},[t._v("\n            您正在重置管理员"+t._s(t.companyDetail.manager)+"的登录密码，我们将以邮件形式将新密码发送到以下邮箱，请注意查收：\n            "+t._s(t.companyDetail.email)+"\n        ")])])],1)},staticRenderFns:[]};var ue=a("VU/8")(pe,me,!1,function(e){a("t/J9")},"data-v-2a724b76",null).exports,fe={props:{activeNode:{type:Object,default:function(){return{}}}},components:{employeeTable:B},data:function(){return{formDataCopy:{},formData:{},type:"watch",ruleValidate:{orgName:[{required:!0,message:this.$t("inputField",{field:this.$t("departName")}),trigger:"blur"},{max:100,message:this.$t("errorMaxLength",{field:this.$t("departName"),length:100})}]}}},methods:{edit:function(){this.type="edit",this.formDataCopy=de()({isStart:"open"===this.formData.status},this.formData)},cancel:function(){this.type="watch"},saveEdit:function(){var t=this;this.type="watch",g.a.post("modifyOrgInfo",{id:this.formDataCopy.id,status:this.formDataCopy.isStart?"open":"close",orgName:this.formDataCopy.orgName,nodeType:this.formDataCopy.nodeType}).then(function(e){e.success?(t.$Message.success("修改成功"),t.formDataCopy.orgName!==t.formData.orgName?t.freshOrg():(t.$emit("fresh-org",t.activeNode),t.getDepDetail())):t.$Message.error("修改失败")})},getDepDetail:function(){var t=this;g.a.post("getOrgInfo",{orgId:this.activeNode.id}).then(function(e){e.success?t.formData=e.data?e.data.basicInfo:{}:t.formData={}})},freshOrg:function(){this.$emit("fresh-org",this.activeNode)}},watch:{activeNode:{handler:function(e,t){this.getDepDetail()},deep:!0,immediate:!0}}},he={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"department-deail"},[a("div",{staticClass:"com-name"},["edit"===t.type?[a("Form",{ref:"formValidate",attrs:{rules:t.ruleValidate,model:t.formDataCopy,"label-width":0,inline:""}},[a("FormItem",{attrs:{prop:"orgName"}},[a("Input",{staticStyle:{width:"280px"},model:{value:t.formDataCopy.orgName,callback:function(e){t.$set(t.formDataCopy,"orgName",e)},expression:"formDataCopy.orgName"}})],1),t._v(" "),a("FormItem",[a("i-switch",{model:{value:t.formDataCopy.isStart,callback:function(e){t.$set(t.formDataCopy,"isStart",e)},expression:"formDataCopy.isStart"}}),t._v(" "),a("span",{class:{started:t.formDataCopy.isStart,"not-started":!t.formDataCopy.isStart}},[t._v("\n                        "+t._s(t.$t(t.formDataCopy.isStart?"commissioned":"hasNotStart"))+"\n                    ")])],1)],1)]:t._e(),t._v(" "),"watch"===t.type?["watch"===t.type?a("span",{directives:[{name:"w-title",rawName:"v-w-title",value:t.formData.orgName,expression:"formData.orgName"}],staticClass:"name"},[t._v("\n                "+t._s(t._f("contentFilter")(t.formData.orgName))+"\n            ")]):t._e(),t._v(" "),a("span",{staticClass:"edit",on:{click:t.edit}},[a("span",{staticClass:"iconfont icon-edit"}),t._v("\n                "+t._s(t.$t("modify"))+"\n            ")]),t._v(" "),a("span",{class:{started:"open"===t.formData.status,"not-started":"close"===t.formData.status}},[t._v("\n                "+t._s(t.$t("open"===t.formData.status?"hasStart":"hasNotStart"))+"\n            ")])]:t._e()],2),t._v(" "),a("ul",{staticClass:"department-info"},[a("li",{staticClass:"list"},[a("div",{staticClass:"info-list1"},[a("span",{staticClass:"info-key"},[t._v("部门ID：")]),t._v(" "),a("span",{directives:[{name:"w-title",rawName:"v-w-title",value:t.formData.id,expression:"formData.id"}],staticClass:"info-val"},[t._v(t._s(t._f("contentFilter")(t.formData.id)))])])]),t._v(" "),"edit"===t.type?a("li",{staticClass:"btn-area"},[a("Button",{staticClass:"ivu-btn-90px",attrs:{type:"primary"},on:{click:t.saveEdit}},[t._v(t._s(t.$t("save")))]),t._v(" "),a("Button",{staticClass:"ivu-btn-90px",attrs:{type:"ghost"},on:{click:t.cancel}},[t._v(t._s(t.$t("cancel")))])],1):t._e()]),t._v(" "),a("employee-table",{attrs:{isDefaultPackUp:!0,"is-department":!0,"search-params":{id:t.activeNode.id},type:"department"}})],1)},staticRenderFns:[]};var ve=a("VU/8")(fe,he,!1,function(e){a("GSVh")},"data-v-1653a59a",null).exports,ye=(a("2Uyi"),{props:{activeNode:{type:Object,default:function(){return{}}}},data:function(){var i=this;return{formDataCopy:{},formData:{cashierName:"",isStart:!1,serverName:"",verifyCashierTypeGroup:"",verifySaleTypeGroup:""},type:"watch",verifyCashierTypeGroupList:[],verifySaleTypeGroupList:[],cashierDetail:{},cashierType:p.d,ruleValidate:{channelName:[{max:100,message:this.$t("errorMaxLength",{field:this.$t("checkoutName"),length:100}),trigger:"blur"},{required:!0,message:this.$t("inputField",{field:this.$t("checkoutName")}),trigger:"blur"}],serverUrl:[{max:50,message:this.$t("errorMaxLength",{field:this.$t("serverName"),length:50}),trigger:"blur"},{required:!0,message:this.$t("inputField",{field:this.$t("serverName")}),trigger:"blur"},{validator:function(e,t,a){t?i.cashierDetail.serverUrl!=t?i.checkServerUrlUnique(t).then(function(e){e.success?e.data?a():a("服务器名称已存在"):a("服务器名称校验失败")}):a():a(i.$t("inputField",{field:i.$t("serverName")}))},trigger:"blur"}]}}},methods:{edit:function(){this.formDataCopy=de()({},this.cashierDetail),this.type="edit"},cancel:function(){this.type="watch",this.$refs.formValidate.resetFields()},saveEdit:function(){var t=this;this.$refs.formValidate.validate(function(e){e&&(t.modifyTable(),t.type="watch")})},getCashierDetail:function(){var t=this;g.a.post("getOrgInfo",{orgId:this.activeNode.id}).then(function(e){e.success?(t.cashierDetail=e.data?e.data.orgSelfChannel:{},t.getCheckItemPage(),t.getSaleItemPage()):t.cashierDetail={}})},getCheckItemPage:function(){var t=this;g.a.post("getOrgGroupList",{groupType:"check",orgId:this.cashierDetail.orgId}).then(function(e){e.success?t.verifyCashierTypeGroupList=e.data?e.data:[]:t.verifyCashierTypeGroupList=[]})},getSaleItemPage:function(){var t=this;g.a.post("getOrgGroupList",{groupType:"sale",orgId:this.cashierDetail.orgId}).then(function(e){e.success?t.verifySaleTypeGroupList=e.data?e.data:[]:t.verifySaleTypeGroupList=[]})},modifyTable:function(){var t=this;g.a.post("modifyTable",{id:this.formDataCopy.id,partnerId:this.formDataCopy.partnerId,channelName:this.formDataCopy.channelName,serverUrl:this.formDataCopy.serverUrl,checkGroupId:this.formDataCopy.checkGroupId?this.formDataCopy.checkGroupId:0,saleGroupId:this.formDataCopy.saleGroupId?this.formDataCopy.saleGroupId:0,nodeType:"table"}).then(function(e){e.success?(t.$Message.success("修改成功"),t.getCashierDetail(),t.$emit("fresh-org",t.activeNode)):t.$Message.error("修改失败")})},checkServerUrlUnique:function(e){return g.a.post("checkServerUrlUnique",{serverUrl:e})}},watch:{activeNode:{handler:function(e,t){this.getCashierDetail()},deep:!0,immediate:!0}},computed:{checkerType:function(){for(var e=0,t=this.cashierType.length;e<t;e++)if(this.cashierDetail.checkerType===this.cashierType[e].value)return this.cashierType[e].label;return""}}}),ge={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"cashier-detail"},[a("Form",{ref:"formValidate",class:{"form-edit":"edit"===t.type,"form-watch":"watch"===t.type},attrs:{model:t.formDataCopy,rules:t.ruleValidate,"label-position":"edit"===t.type?"top":"left",inline:""}},[a("div",{staticClass:"com-name"},[a("span",{directives:[{name:"w-title",rawName:"v-w-title",value:t.cashierDetail.channelName,expression:"cashierDetail.channelName"}],staticClass:"name"},[t._v("\n                "+t._s(t._f("contentFilter")(t.cashierDetail.channelName))+"\n            ")]),t._v(" "),"watch"===t.type?a("span",{staticClass:"edit",on:{click:t.edit}},[a("span",{staticClass:"iconfont icon-edit"}),t._v("\n                "+t._s(t.$t("modify"))+"\n            ")]):t._e()]),t._v(" "),a("div",{class:{"form-area":"edit"===t.type},staticStyle:{clear:"both"}},[a("i-row",[a("i-col",{attrs:{span:"12"}},["edit"===t.type?a("FormItem",{attrs:{label:"款台名称：",required:!0,prop:"channelName","label-width":"edit"===t.type?0:150}},[a("Input",{model:{value:t.formDataCopy.channelName,callback:function(e){t.$set(t.formDataCopy,"channelName","string"==typeof e?e.trim():e)},expression:"formDataCopy.channelName"}})],1):a("div",{staticClass:"node-info"},[a("span",{staticClass:"info-key"},[t._v("款台名称：")]),t._v(" "),a("span",{directives:[{name:"w-title",rawName:"v-w-title",value:t.cashierDetail.channelName,expression:"cashierDetail.channelName"}],staticClass:"info-val"},[t._v("\n                            "+t._s(t.cashierDetail.channelName)+"\n                        ")])])],1),t._v(" "),a("i-col",{attrs:{span:"12"}},["edit"===t.type?a("FormItem",{attrs:{label:"款台ID：","label-width":"edit"===t.type?0:150}},[a("Input",{attrs:{disabled:""},model:{value:t.formDataCopy.partnerId,callback:function(e){t.$set(t.formDataCopy,"partnerId","string"==typeof e?e.trim():e)},expression:"formDataCopy.partnerId"}})],1):a("div",{staticClass:"node-info"},[a("span",{staticClass:"info-key"},[t._v("款台ID：")]),t._v(" "),a("span",{directives:[{name:"w-title",rawName:"v-w-title",value:t.cashierDetail.partnerId,expression:"cashierDetail.partnerId"}],staticClass:"info-val"},[t._v("\n                            "+t._s(t.cashierDetail.partnerId)+"\n                        ")])])],1)],1),t._v(" "),a("i-row",[a("i-col",{attrs:{span:"12"}},["edit"===t.type?a("FormItem",{attrs:{prop:"serverUrl",required:!0,"label-width":"edit"===t.type?0:150}},[a("Input",{model:{value:t.formDataCopy.serverUrl,callback:function(e){t.$set(t.formDataCopy,"serverUrl","string"==typeof e?e.trim():e)},expression:"formDataCopy.serverUrl"}}),t._v(" "),a("template",{slot:"label"},[a("span",[t._v("服务器名称：")]),t._v(" "),a("Tooltip",{attrs:{placement:"bottom",transfer:""}},[a("div",{staticClass:"tips-content",attrs:{slot:"content"},slot:"content"},[t._v("\n                                    "+t._s(t.$t("serverNameTips"))+"\n                                ")]),t._v(" "),a("span",{staticClass:"iconfont icon-note",staticStyle:{color:"#9e9e9e"}})])],1)],2):a("div",{staticClass:"node-info"},[a("span",{staticClass:"info-key"},[t._v("\n                            服务器名称：\n                             "),a("Tooltip",{attrs:{placement:"bottom",transfer:""}},[a("div",{staticClass:"tips-content",attrs:{slot:"content"},slot:"content"},[t._v("\n                                    "+t._s(t.$t("serverNameTips"))+"\n                                ")]),t._v(" "),a("span",{staticClass:"iconfont icon-note"})])],1),t._v(" "),a("span",{directives:[{name:"w-title",rawName:"v-w-title",value:t.cashierDetail.serverUrl,expression:"cashierDetail.serverUrl"}],staticClass:"info-val"},[t._v("\n                            "+t._s(t.cashierDetail.serverUrl)+"\n                        ")])])],1),t._v(" "),a("i-col",{attrs:{span:"12"}},["edit"===t.type?a("FormItem",{attrs:{label:"款台类型：","label-width":"edit"===t.type?0:150}},[a("Select",{attrs:{disabled:""},model:{value:t.formDataCopy.checkerType,callback:function(e){t.$set(t.formDataCopy,"checkerType",e)},expression:"formDataCopy.checkerType"}},t._l(t.cashierType,function(e){return a("Option",{key:e.value,staticClass:"overflow-tip",attrs:{value:e.value}},[t._v("\n                                "+t._s(t.$t(e.label))+"\n                            ")])}))],1):a("div",{staticClass:"node-info"},[a("span",{staticClass:"info-key"},[t._v("款台类型：")]),t._v(" "),a("span",{directives:[{name:"w-title",rawName:"v-w-title",value:t.$t(t.checkerType),expression:"$t(checkerType)"}],staticClass:"info-val"},[t._v("\n                             "+t._s(t._f("contentFilter")(t.$t(t.checkerType)))+"\n                        ")])])],1)],1),t._v(" "),a("i-row",[a("i-col",{attrs:{span:"12"}},["edit"!==t.type||"check"!==t.formDataCopy.checkerType&&"combine"!==t.formDataCopy.checkerType?t._e():a("FormItem",{attrs:{label:"所属核销设备分组：",prop:"checkGroupId","label-width":"edit"===t.type?0:150}},[a("Select",{attrs:{clearable:!0,disabled:"sale"===t.formDataCopy.checkerType},model:{value:t.formDataCopy.checkGroupId,callback:function(e){t.$set(t.formDataCopy,"checkGroupId",e)},expression:"formDataCopy.checkGroupId"}},t._l(t.verifyCashierTypeGroupList,function(e){return a("Option",{directives:[{name:"w-title",rawName:"v-w-title",value:e.groupName,expression:"item.groupName"}],key:e.id,staticClass:"overflow-tip",attrs:{value:e.id}},[t._v("\n                                "+t._s(t.$t(e.groupName))+"\n                            ")])}))],1),t._v(" "),"edit"===t.type||"check"!==t.cashierDetail.checkerType&&"combine"!==t.cashierDetail.checkerType?t._e():a("div",{staticClass:"node-info"},[a("span",{staticClass:"info-key"},[t._v("所属核销设备分组：")]),t._v(" "),a("span",{directives:[{name:"w-title",rawName:"v-w-title",value:t.cashierDetail.checkGroupName,expression:"cashierDetail.checkGroupName"}],staticClass:"info-val"},[t._v("\n                            "+t._s(t.cashierDetail.checkGroupName?t.cashierDetail.checkGroupName:"未分组")+"\n                        ")])])],1),t._v(" "),a("i-col",{attrs:{span:"12"}},["edit"!==t.type||"sale"!==t.formDataCopy.checkerType&&"combine"!==t.formDataCopy.checkerType?t._e():a("FormItem",{attrs:{label:"所属销售渠道分组：",prop:"saleGroupId","label-width":"edit"===t.type?0:150}},[a("Select",{attrs:{clearable:!0,disabled:"check"===t.formDataCopy.checkerType},model:{value:t.formDataCopy.saleGroupId,callback:function(e){t.$set(t.formDataCopy,"saleGroupId",e)},expression:"formDataCopy.saleGroupId"}},t._l(t.verifySaleTypeGroupList,function(e){return a("Option",{directives:[{name:"w-title",rawName:"v-w-title",value:e.groupName,expression:"item.groupName"}],key:e.id,staticClass:"overflow-tip",attrs:{value:e.id}},[t._v("\n                                "+t._s(e.groupName)+"\n                            ")])}))],1),t._v(" "),"edit"===t.type||"sale"!==t.cashierDetail.checkerType&&"combine"!==t.cashierDetail.checkerType?t._e():a("div",{staticClass:"node-info"},[a("span",{staticClass:"info-key"},[t._v("所属销售渠道分组：")]),t._v(" "),a("span",{directives:[{name:"w-title",rawName:"v-w-title",value:t.cashierDetail.saleGroupName,expression:"cashierDetail.saleGroupName"}],staticClass:"info-val"},[t._v("\n                            "+t._s(t.cashierDetail.saleGroupName?t.cashierDetail.saleGroupName:"未分组")+"\n                        ")])])],1)],1),t._v(" "),"edit"===t.type?a("i-row",{staticStyle:{"margin-top":"10px"}},[a("i-col",{staticStyle:{"text-align":"center"},attrs:{span:"24"}},[a("Button",{staticClass:"ivu-btn-90px",staticStyle:{"margin-right":"5px"},attrs:{type:"primary"},on:{click:t.saveEdit}},[t._v(t._s(t.$t("save")))]),t._v(" "),a("Button",{staticClass:"ivu-btn-90px",attrs:{type:"ghost"},on:{click:t.cancel}},[t._v(t._s(t.$t("cancel")))])],1)],1):t._e()],1)])],1)},staticRenderFns:[]};var De=a("VU/8")(ye,ge,!1,function(e){a("Aatg")},"data-v-13c578ec",null).exports,Ce=[{title:"序号",minWidth:90,field:"index"},{title:"合作伙伴名称",minWidth:150,field:"channelName"},{title:"协议有效期起始日期",minWidth:190,field:"startDate"},{title:"协议有效期结束日期",minWidth:190,field:"endDate"},{title:"当前状态",minWidth:130,field:"status"}],_e={props:{"search-params":{typee:Object,default:function(){return{}}}},components:{tableCom:V.a},data:function(){return{paratner:Ce,tableData:[],totalCount:0,pageNo:1,pageSize:10,isPackUp:!1}},methods:{queryList:function(){var t=this;g.a.post("queryPartnerList",{orgId:this.searchParams.id,nodeType:"partner",pageNo:this.pageNo,pageSize:this.pageSize}).then(function(e){e.success?(t.tableData=e.data?e.data.data:[],t.totalCount=e.data.totalRow):(t.tableData=[],t.totalCount=0)})}},computed:{tableShow:function(){return this.searchParams&&this.searchParams.id}}},be={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"partner"},[a("div",{staticClass:"pick-up-title"},[a("span",{staticClass:"label"},[t._v("合作伙伴")]),t._v(" "),a("span",{staticClass:"back-up",on:{click:function(e){t.isPackUp=!t.isPackUp}}},[t._v("\n        "+t._s(t.$t(t.isPackUp?"backUp":"upLoad"))+"\n            "),a("span",{staticClass:"iconfont icon-arrow-down",class:{"icon-reverse":t.isPackUp}})])]),t._v(" "),a("transition",{attrs:{name:"fade"}},[t.isPackUp?a("div",{staticClass:"table-wrap"},[t.tableShow?a("table-com",{attrs:{"column-data":t.paratner,"table-data":t.tableData,border:!0,"page-no-d":t.pageNo,"show-pagination":!0,"page-size-d":t.pageSize,"total-count":t.totalCount,"auto-height":!0,"table-com-min-height":280},on:{"update:pageNoD":function(e){t.pageNo=e},"update:pageSizeD":function(e){t.pageSize=e},"query-data":t.queryList},scopedSlots:t._u([{key:"column0",fn:function(e){return a("el-table-column",{attrs:{label:e.title,"show-overflow-tooltip":"",width:e.width,"min-width":e.minWidth},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                        "+t._s((t.pageNo-1)*t.pageSize+e.$index+1)+"\n                    ")]}}])})}},{key:"column4",fn:function(e){return a("el-table-column",{attrs:{label:e.title,"show-overflow-tooltip":"",width:e.width,"min-width":e.minWidth},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                        "+t._s(t.$t("valid"===e.row.status?"hasStart":"hasNotStart"))+"\n                    ")]}}])})}}])}):t._e()],1):t._e()])],1)},staticRenderFns:[]};var we=a("VU/8")(_e,be,!1,function(e){a("lyKt")},"data-v-ab3eb4d8",null).exports,Se={props:{activeNode:{type:Object,default:function(){return{}}},activeTap:{type:String,default:""}},components:{tableCom:O,openedService:Y,subScene:se,subDepartment:le,partner:we,cityPlugin:_,editModal:d.a},data:function(){var i=this;return{formDataCopy:{},superiorList:[],fianceSuperiorList:[],type:"watch",sceneDetail:{},ruleValidate:{orgName:[{max:100,message:this.$t("errorMaxLength",{field:this.$t("scenicName"),length:100}),trigger:"blur"},{required:!0,message:this.$t("inputField",{field:this.$t("scenicName")}),trigger:"blur"}],checkinCode:[{min:2,max:8,message:this.$t("rangeBitError",{field:this.$t("enterpriseCode"),length:8,min:1,max:8}),trigger:"blur"}],email:[{required:!0,message:this.$t("inputField",{field:this.$t("email")}),trigger:"blur"},{validator:function(e,t,a){t?h.validator.isEmail(t)?a():a(i.$t("errorFormat",{field:i.$t("email")})):a(i.$t("inputField",{field:i.$t("email")}))},trigger:"blur"}],address:[{max:100,message:this.$t("errorMaxLength",{field:this.$t("address"),length:100}),trigger:"blur"}],telephone:[{max:20,message:this.$t("errorMaxLength",{field:this.$t("phone"),length:20}),trigger:"blur"},{validator:function(e,t,a){t?h.validator.isTelephone(t)?a():a(i.$t("errorFormat",{field:i.$t("phone")})):a()},trigger:"blur"}],tex:[{max:20,message:this.$t("errorMaxLength",{field:this.$t("fax"),length:20}),trigger:"blur"}],linkName:[{required:!0,message:this.$t("inputField",{field:this.$t("person")}),trigger:"blur"},{max:10,message:this.$t("errorMaxLength",{field:this.$t("person"),length:10}),trigger:"blur"}],parentManageId:[{required:!0,message:this.$t("selectField",{msg:this.$t("superior")}),trigger:"blur"}],parentEconomicId:[{required:!0,message:this.$t("selectField",{msg:this.$t("fianceSuperior")}),trigger:"blur"}]}}},methods:{cancel:function(){this.$refs.formValidate.resetFields(),this.type="watch"},saveEdit:function(){var t=this;this.$refs.formValidate.validate(function(e){e&&(t.type="watch",g.a.post("modifyOrgInfo",{id:t.formDataCopy.id,status:t.formDataCopy.isStart?"open":"close",orgName:t.formDataCopy.orgName,checkinCode:t.formDataCopy.checkinCode,email:t.formDataCopy.email,province:t.formDataCopy.provinceCode,city:t.formDataCopy.cityCode,district:t.formDataCopy.districtCode,telephone:t.formDataCopy.telephone,tex:t.formDataCopy.tex,linkName:t.formDataCopy.linkName,parentManageId:t.formDataCopy.parentManageId,parentEconomicId:t.formDataCopy.parentEconomicId,address:t.formDataCopy.address,managerId:t.formDataCopy.managerId,nodeType:t.formDataCopy.nodeType}).then(function(e){e.success?(t.$Message.success("修改成功"),t.formDataCopy.orgName!==t.sceneDetail.orgName?t.freshOrg():t.formDataCopy.parentManageId!==t.sceneDetail.parentManageId?t.freshOrg():t.formDataCopy.parentEconomicId!==t.sceneDetail.parentEconomicId?t.freshOrg():t.getSceneDetail()):t.$Message.error("修改失败"|e.message)}))})},edit:function(){this.formDataCopy=de()({isStart:"open"===this.sceneDetail.status},this.sceneDetail),this.type="edit"},confimChangePass:function(){var t=this;g.a.post("resetManagerPassword",{orgId:this.activeNode.id,managerId:this.sceneDetail.managerId,email:this.sceneDetail.email}).then(function(e){e.success?t.$Message.success("重置管理员"+t.sceneDetail.manager+"密码成功"):t.$Message.error(e.message||"重置失败")}).finally(function(){t.$refs.editModal.hide()})},resetPass:function(){var e=this;this.$refs.editModal.show({title:"重置密码",confirmCallback:function(){e.confimChangePass()}})},freshOrg:function(){this.$emit("fresh-org",this.activeNode)},getSceneDetail:function(){var t=this;g.a.post("getOrgInfo",{orgId:this.activeNode.id}).then(function(e){e.success?t.sceneDetail=e.data?e.data.basicInfo:{}:t.sceneDetail={}})},getParentManages:function(){var t=this;g.a.post("getOrgsByManageType",{orgId:this.activeNode.id,manageType:"manage",nodeType:this.activeNode.type}).then(function(e){e.success?t.superiorList=e.data?e.data.filter(function(e){return e.id!==t.activeNode.id}):[]:t.superiorList=[]})},getParentEconomic:function(){var t=this;g.a.post("getOrgsByManageType",{orgId:this.activeNode.id,manageType:"economic",nodeType:this.activeNode.type}).then(function(e){e.success?t.fianceSuperiorList=e.data?e.data.filter(function(e){return e.id!==t.activeNode.id}):[]:t.fianceSuperiorList=[]})},changeCity:function(e){e.province&&0<s()(e.province).length?(this.formDataCopy.provinceCode=e.province.provinceid,this.formDataCopy.province=e.province.province):(this.formDataCopy.provinceCode="000000",this.formDataCopy.province=""),e.city&&0<s()(e.city).length?(this.formDataCopy.cityCode=e.city.cityid,this.formDataCopy.city=e.city.city):(this.formDataCopy.cityCode="000000",this.formDataCopy.city=""),e.area&&0<s()(e.area).length?(this.formDataCopy.districtCode=e.area.areaid,this.formDataCopy.district=e.area.area):(this.formDataCopy.districtCode="000000",this.formDataCopy.district="")}},watch:{activeNode:{handler:function(e,t){this.getSceneDetail()},deep:!0,immediate:!0}},computed:{companyPlace:function(){var e="";return this.sceneDetail&&this.sceneDetail.province&&(e+=this.sceneDetail.province),this.sceneDetail&&this.sceneDetail.city&&(e+=this.sceneDetail.city),this.sceneDetail&&this.sceneDetail.district&&(e+=this.sceneDetail.district),e},defaultAddress:function(){return!!(this.sceneDetail&&0<s()(this.sceneDetail).length)&&{province:{provinceid:this.sceneDetail.provinceCode,province:this.sceneDetail.province},city:{cityid:this.sceneDetail.cityCode,city:this.sceneDetail.city},area:{areaid:this.sceneDetail.districtCode,area:this.sceneDetail.district}}}},created:function(){this.getParentManages(),this.getParentEconomic()}},Ne={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"scene-detail"},[a("Form",{ref:"formValidate",class:{"form-edit":"edit"===t.type,"form-watch":"watch"===t.type},attrs:{model:t.formDataCopy,rules:t.ruleValidate,"label-position":"edit"===t.type?"top":"left",inline:""}},[a("div",{staticClass:"com-name",class:{"com-min-width":"edit"===t.type}},["edit"===t.type?[a("i-row",[a("i-col",{staticStyle:{width:"240px"},attrs:{span:"9"}},[a("FormItem",{attrs:{prop:"orgName"}},[a("Input",{staticStyle:{width:"220px"},model:{value:t.formDataCopy.orgName,callback:function(e){t.$set(t.formDataCopy,"orgName","string"==typeof e?e.trim():e)},expression:"formDataCopy.orgName"}})],1)],1),t._v(" "),1!==t.activeNode.level?a("i-col",{staticStyle:{width:"73px"},attrs:{span:"5"}},[a("FormItem",[a("i-switch",{model:{value:t.formDataCopy.isStart,callback:function(e){t.$set(t.formDataCopy,"isStart",e)},expression:"formDataCopy.isStart"}}),t._v(" "),a("span",{class:{started:t.formDataCopy.isStart,"not-started":!t.formDataCopy.isStart}},[t._v("\n                            "+t._s(t.$t(t.formDataCopy.isStart?"hasStart":"hasNotStart"))+"\n                        ")])],1)],1):t._e()],1)]:t._e(),t._v(" "),"watch"===t.type?["watch"===t.type?a("span",{directives:[{name:"w-title",rawName:"v-w-title",value:t.sceneDetail.orgName,expression:"sceneDetail.orgName"}],staticClass:"name"},[t._v("\n                    "+t._s(t.sceneDetail.orgName)+"\n                ")]):t._e(),t._v(" "),a("span",{staticClass:"edit",on:{click:t.edit}},[a("span",{staticClass:"iconfont icon-edit"}),t._v("\n                    "+t._s(t.$t("modify"))+"\n                ")]),t._v(" "),a("span",{class:{started:"open"===t.sceneDetail.status,"not-started":"close"===t.sceneDetail.status}},[t._v("\n                    "+t._s(t.$t("open"===t.sceneDetail.status?"hasStart":"hasNotStart"))+"\n                ")])]:t._e()],2),t._v(" "),a("div",{class:{"form-area":"edit"===t.type}},[a("i-row",[a("i-col",{attrs:{span:"12"}},["edit"===t.type?a("FormItem",{attrs:{label:"公司ID：","label-width":"edit"===t.type?0:150}},[a("Input",{attrs:{disabled:""},model:{value:t.formDataCopy.id,callback:function(e){t.$set(t.formDataCopy,"id","string"==typeof e?e.trim():e)},expression:"formDataCopy.id"}})],1):a("div",{staticClass:"node-info"},[a("span",{staticClass:"info-key"},[t._v("公司ID：")]),t._v(" "),a("span",{directives:[{name:"w-title",rawName:"v-w-title",value:t.sceneDetail.id,expression:"sceneDetail.id"}],staticClass:"info-val"},[t._v("\n                            "+t._s(t._f("contentFilter")(t.sceneDetail.id))+"\n                        ")])])],1),t._v(" "),a("i-col",{attrs:{span:"12"}},["edit"===t.type?a("FormItem",{attrs:{label:"公司编码：","label-width":"edit"===t.type?0:150}},[a("Input",{attrs:{disabled:""},model:{value:t.formDataCopy.nodeCode,callback:function(e){t.$set(t.formDataCopy,"nodeCode","string"==typeof e?e.trim():e)},expression:"formDataCopy.nodeCode"}})],1):a("div",{staticClass:"node-info"},[a("span",{staticClass:"info-key"},[t._v("公司编码：")]),t._v(" "),a("span",{directives:[{name:"w-title",rawName:"v-w-title",value:t.sceneDetail.nodeCode,expression:"sceneDetail.nodeCode"}],staticClass:"info-val"},[t._v("\n                            "+t._s(t._f("contentFilter")(t.sceneDetail.nodeCode))+"\n                        ")])])],1)],1),t._v(" "),a("i-row",[a("i-col",{attrs:{span:"12"}},["edit"===t.type?a("FormItem",{attrs:{prop:"checkinCode",label:"企业编码(线下核销)：","label-width":"edit"===t.type?0:150}},[a("Input",{model:{value:t.formDataCopy.checkinCode,callback:function(e){t.$set(t.formDataCopy,"checkinCode","string"==typeof e?e.trim():e)},expression:"formDataCopy.checkinCode"}})],1):a("div",{staticClass:"node-info"},[a("span",{staticClass:"info-key"},[t._v("企业编码(线下核销)：")]),t._v(" "),a("span",{directives:[{name:"w-title",rawName:"v-w-title",value:t.sceneDetail.checkinCode,expression:"sceneDetail.checkinCode"}],staticClass:"info-val"},[t._v("\n                            "+t._s(t._f("contentFilter")(t.sceneDetail.checkinCode))+"\n                        ")])])],1),t._v(" "),a("i-col",{attrs:{span:"12"}},["edit"===t.type?a("FormItem",{attrs:{label:"全民分销邀请码：","label-width":"edit"===t.type?0:150}},[a("Input",{attrs:{disabled:""},model:{value:t.formDataCopy.saleCode,callback:function(e){t.$set(t.formDataCopy,"saleCode","string"==typeof e?e.trim():e)},expression:"formDataCopy.saleCode"}})],1):a("div",{staticClass:"node-info"},[a("span",{staticClass:"info-key"},[t._v("全民分销邀请码：")]),t._v(" "),a("span",{directives:[{name:"w-title",rawName:"v-w-title",value:t.sceneDetail.saleCode,expression:"sceneDetail.saleCode"}],staticClass:"info-val"},[t._v("\n                            "+t._s(t._f("contentFilter")(t.sceneDetail.saleCode))+"\n                        ")])])],1)],1),t._v(" "),a("i-row",[a("i-col",{attrs:{span:"12"}},["edit"===t.type?a("FormItem",{attrs:{label:"管理账号：","label-width":"edit"===t.type?0:150}},[a("Input",{attrs:{disabled:""},model:{value:t.formDataCopy.manager,callback:function(e){t.$set(t.formDataCopy,"manager","string"==typeof e?e.trim():e)},expression:"formDataCopy.manager"}})],1):a("div",{staticClass:"node-info"},[a("span",{staticClass:"info-key"},[t._v("管理账号：")]),t._v(" "),a("span",{directives:[{name:"w-title",rawName:"v-w-title",value:t.sceneDetail.manager,expression:"sceneDetail.manager"}],staticClass:"info-val"},[t._v("\n                             "+t._s(t._f("contentFilter")(t.sceneDetail.manager))+"\n                            "),t.activeNode&&1!==t.activeNode.level?a("span",{staticClass:"reset-pass",on:{click:t.resetPass}},[t._v("重置密码")]):t._e()])])],1),t._v(" "),a("i-col",{attrs:{span:"12"}},["edit"===t.type?a("FormItem",{attrs:{prop:"email",label:"电子邮箱：","label-width":"edit"===t.type?0:150}},[a("Input",{model:{value:t.formDataCopy.email,callback:function(e){t.$set(t.formDataCopy,"email",e)},expression:"formDataCopy.email"}})],1):a("div",{staticClass:"node-info"},[a("span",{staticClass:"info-key"},[t._v("电子邮箱：")]),t._v(" "),a("span",{directives:[{name:"w-title",rawName:"v-w-title",value:t.sceneDetail.email,expression:"sceneDetail.email"}],staticClass:"info-val"},[t._v("\n                            "+t._s(t._f("contentFilter")(t.sceneDetail.email))+"\n                        ")])])],1)],1),t._v(" "),a("i-row",[a("i-col",{attrs:{span:"12"}},[t.defaultAddress&&"edit"===t.type?a("FormItem",{attrs:{label:"所在地：","label-width":"edit"===t.type?0:150}},[a("city-plugin",{attrs:{defaultValue:t.defaultAddress},on:{select:t.changeCity}})],1):a("div",{staticClass:"node-info"},[a("span",{staticClass:"info-key"},[t._v("所在地：")]),t._v(" "),a("span",{directives:[{name:"w-title",rawName:"v-w-title",value:t.companyPlace,expression:"companyPlace"}],staticClass:"info-val"},[t._v("\n                             "+t._s(t._f("contentFilter")(t.companyPlace))+"\n                        ")])])],1),t._v(" "),a("i-col",{attrs:{span:"12"}},["edit"===t.type?a("FormItem",{attrs:{prop:"address",label:"详细地址：","label-width":"edit"===t.type?0:150}},[a("Input",{model:{value:t.formDataCopy.address,callback:function(e){t.$set(t.formDataCopy,"address",e)},expression:"formDataCopy.address"}})],1):a("div",{staticClass:"node-info"},[a("span",{staticClass:"info-key"},[t._v("详细地址：")]),t._v(" "),a("span",{directives:[{name:"w-title",rawName:"v-w-title",value:t.sceneDetail.address,expression:"sceneDetail.address"}],staticClass:"info-val"},[t._v("\n                            "+t._s(t._f("contentFilter")(t.sceneDetail.address))+"\n                        ")])])],1)],1),t._v(" "),a("i-row",[a("i-col",{attrs:{span:"12"}},["edit"===t.type?a("FormItem",{attrs:{prop:"telephone",label:"电话：","label-width":"edit"===t.type?0:150}},[a("Input",{model:{value:t.formDataCopy.telephone,callback:function(e){t.$set(t.formDataCopy,"telephone",e)},expression:"formDataCopy.telephone"}})],1):a("div",{staticClass:"node-info"},[a("span",{staticClass:"info-key"},[t._v("电话：")]),t._v(" "),a("span",{directives:[{name:"w-title",rawName:"v-w-title",value:t.sceneDetail.telephone,expression:"sceneDetail.telephone"}],staticClass:"info-val"},[t._v("\n                            "+t._s(t._f("contentFilter")(t.sceneDetail.telephone))+"\n                        ")])])],1),t._v(" "),a("i-col",{attrs:{span:"12"}},["edit"===t.type?a("FormItem",{attrs:{prop:"tex",label:"传真：","label-width":"edit"===t.type?0:150}},[a("Input",{model:{value:t.formDataCopy.tex,callback:function(e){t.$set(t.formDataCopy,"tex",e)},expression:"formDataCopy.tex"}})],1):a("div",{staticClass:"node-info"},[a("span",{staticClass:"info-key"},[t._v("传真：")]),t._v(" "),a("span",{directives:[{name:"w-title",rawName:"v-w-title",value:t.sceneDetail.tex,expression:"sceneDetail.tex"}],staticClass:"info-val"},[t._v("\n                            "+t._s(t._f("contentFilter")(t.sceneDetail.tex))+"\n                        ")])])],1)],1),t._v(" "),a("i-row",[a("i-col",{attrs:{span:"12"}},["edit"===t.type?a("FormItem",{attrs:{prop:"linkName",label:"联系人：","label-width":"edit"===t.type?0:150}},[a("Input",{model:{value:t.formDataCopy.linkName,callback:function(e){t.$set(t.formDataCopy,"linkName",e)},expression:"formDataCopy.linkName"}})],1):a("div",{staticClass:"node-info"},[a("span",{staticClass:"info-key"},[t._v("联系人：")]),t._v(" "),a("span",{directives:[{name:"w-title",rawName:"v-w-title",value:t.sceneDetail.linkName,expression:"sceneDetail.linkName"}],staticClass:"info-val"},[t._v("\n                            "+t._s(t._f("contentFilter")(t.sceneDetail.linkName))+"\n                        ")])])],1),t._v(" "),a("i-col",{attrs:{span:"12"}},["edit"===t.type?a("FormItem",{attrs:{prop:"parentManageId",label:"管理上级：","label-width":"edit"===t.type?0:150}},[a("Select",{attrs:{disabled:t.activeNode&&1===t.activeNode.level},model:{value:t.formDataCopy.parentManageId,callback:function(e){t.$set(t.formDataCopy,"parentManageId",e)},expression:"formDataCopy.parentManageId"}},t._l(t.superiorList,function(e){return a("Option",{key:e.id,attrs:{value:e.id}},[t._v("\n                                "+t._s(e.orgName)+"\n                            ")])}))],1):a("div",{staticClass:"node-info"},[a("span",{staticClass:"info-key"},[t._v("管理上级：")]),t._v(" "),a("span",{directives:[{name:"w-title",rawName:"v-w-title",value:t.sceneDetail.parentManager,expression:"sceneDetail.parentManager"}],staticClass:"info-val"},[1!==t.activeNode.level?[t._v("\n                                "+t._s(t._f("contentFilter")(t.sceneDetail.parentManager))+"\n                            ")]:[t._v("-")]],2)])],1)],1),t._v(" "),a("i-row",[a("i-col",{attrs:{span:"12"}},["edit"===t.type?a("FormItem",{attrs:{prop:"parentEconomicId",label:"财务上级：","label-width":"edit"===t.type?0:150}},[a("Select",{attrs:{disabled:t.activeNode&&1===t.activeNode.level},model:{value:t.formDataCopy.parentEconomicId,callback:function(e){t.$set(t.formDataCopy,"parentEconomicId",e)},expression:"formDataCopy.parentEconomicId"}},t._l(t.fianceSuperiorList,function(e){return a("Option",{key:e.id,attrs:{value:e.id}},[t._v("\n                                "+t._s(e.orgName)+"\n                            ")])}))],1):a("div",{staticClass:"node-info"},[a("span",{staticClass:"info-key"},[t._v("财务上级：")]),t._v(" "),a("span",{directives:[{name:"w-title",rawName:"v-w-title",value:t.sceneDetail.parentEconomic,expression:"sceneDetail.parentEconomic"}],staticClass:"info-val"},[1!==t.activeNode.level?[t._v("\n                                "+t._s(t._f("contentFilter")(t.sceneDetail.parentEconomic))+"\n                            ")]:[t._v("-")]],2)])],1)],1),t._v(" "),"edit"===t.type?a("i-row",{staticStyle:{"margin-top":"10px"}},[a("i-col",{staticStyle:{"text-align":"center"},attrs:{span:"24"}},[a("Button",{staticClass:"ivu-btn-90px",staticStyle:{"margin-right":"5px"},attrs:{type:"primary"},on:{click:t.saveEdit}},[t._v(t._s(t.$t("save")))]),t._v(" "),a("Button",{staticClass:"ivu-btn-90px",attrs:{type:"ghost"},on:{click:t.cancel}},[t._v(t._s(t.$t("cancel")))])],1)],1):t._e()],1)]),t._v(" "),a("sub-scene",{attrs:{activeTap:t.activeTap,"search-params":{id:t.activeNode.id}}}),t._v(" "),a("sub-department",{attrs:{activeTap:t.activeTap,"search-params":{id:t.activeNode.id}},on:{"org-change":t.freshOrg}}),t._v(" "),a("partner",{attrs:{"search-params":{id:t.activeNode.id}}}),t._v(" "),a("opened-service",{attrs:{isDefaultPackUp:!1,type:"scene","scene-detail":t.sceneDetail,"search-params":{id:t.activeNode.id}}}),t._v(" "),a("edit-modal",{ref:"editModal"},[a("div",{staticStyle:{padding:"0 20px","word-break":"break-all",width:"100%"}},[t._v("\n            您正在重置管理员"+t._s(t.sceneDetail.manager)+"的登录密码，我们将以邮件形式将新密码发送到以下邮箱，请注意查收：\n            "+t._s(t.sceneDetail.email)+"\n        ")])])],1)},staticRenderFns:[]};var ke={components:{structureTree:M,companyDetail:ue,departmentDetail:ve,cashierDetail:De,sceneDetail:a("VU/8")(Se,Ne,!1,function(e){a("7fhe")},"data-v-918d4606",null).exports},data:function(){return{structureData:{},componentName:"company",nodeId:"",activeTap:"manage",activeNode:{}}},methods:{getParams:function(e){},getCompanyTree:function(){var t=this,a=JSON.parse(o()(this.activeNode));this.activeNode={},g.a.post("getOrgTree",{manageType:this.activeTap,showScene:"manage"}).then(function(e){e.success?(t.structureData=e.data?e.data:{},s()(a).length<1?t.activeNode=JSON.parse(o()({id:t.structureData.id,level:t.structureData.level,type:t.structureData.nodeType})):t.activeNode=a):(t.structureData={},t.activeNode={})})},switchTap:function(e){this.activeTap=e,this.getCompanyTree()},freshOrgInfo:function(e){this.activeNode=e,this.getCompanyTree()}},computed:{componentSelect:function(){return"company"===this.activeNode.type?"companyDetail":"department"===this.activeNode.type?"departmentDetail":"table"===this.activeNode.type?"cashierDetail":"scenic"===this.activeNode.type?"sceneDetail":""},nodeKey:function(){return this.activeNode?this.activeNode.id:""}},created:function(){this.getCompanyTree()}},$e={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"isp-internet-detail"},[a("div",{staticClass:"structure"},[a("structure-tree",{attrs:{"tree-data":t.structureData,activeNode:t.activeNode},on:{"update:activeNode":function(e){t.activeNode=e},"switch-tap":t.switchTap,"fresh-org":t.freshOrgInfo},model:{value:t.componentName,callback:function(e){t.componentName=e},expression:"componentName"}})],1),t._v(" "),a("transition",{attrs:{name:"fade"}},[a(t.componentSelect,{key:t.nodeKey,tag:"component",attrs:{activeTap:t.activeTap,activeNode:t.activeNode},on:{"fresh-org":t.freshOrgInfo}})],1)],1)},staticRenderFns:[]};var xe=a("VU/8")(ke,$e,!1,function(e){a("2jtW")},"data-v-1419d98b",null);t.default=xe.exports},"t/J9":function(e,t){}});